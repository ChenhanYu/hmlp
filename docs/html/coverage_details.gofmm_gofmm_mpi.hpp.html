
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <title>Head</title>
  <style media="screen" type="text/css">
  
    body
    {
      color: #000000;
      background-color: #FFFFFF;
    }

    /* Link formats: use maroon w/underlines */
    a:link
    {
      color: navy;
      text-decoration: underline;
    }
    a:visited
    {
      color: maroon;
      text-decoration: underline;
    }
    a:active
    {
      color: navy;
      text-decoration: underline;
    }
    
    /*** TD formats ***/
    td
    {
      font-family: sans-serif;
    }
    td.title
    {
      text-align: center;
      padding-bottom: 10px;
      font-size: 20pt;
      font-weight: bold;
    }
    
    /* TD Header Information */
    td.headerName
    {
      text-align: right;
      color: black;
      padding-right: 6px;
      font-weight: bold;
      vertical-align: top;
      white-space: nowrap;
    }
    td.headerValue
    {
      text-align: left;
      color: blue;
      font-weight: bold;
      white-space: nowrap;
    }
    td.headerTableEntry
    {
      text-align: right;
      color: black;
      font-weight: bold;
      white-space: nowrap;
      padding-left: 12px;
      padding-right: 4px;
      background-color: LightBlue;
    }
    td.headerValueLeg
    {
      text-align: left;
      color: black;
      font-size: 80%;
      white-space: nowrap;
      padding-left: 10px;
      padding-right: 10px;
      padding-top: 2px;
    }
    
    /* Color of horizontal ruler */
    td.hr
    {
      background-color: navy;
      height:3px;
    }
    /* Footer format */
    td.footer
    {
      text-align: center;
      padding-top: 3px;
      font-family: sans-serif;
    }

    /* Coverage Table */    

    td.coverTableHead
    {
      text-align: center;
      color: white;
      background-color: SteelBlue;
      font-family: sans-serif;
      font-size: 120%;
      white-space: nowrap;
      padding-left: 4px;
      padding-right: 4px;
    }
    td.coverFile
    {
      text-align: left;
      padding-left: 10px;
      padding-right: 20px; 
      color: black;
      background-color: LightBlue;
      font-family: monospace;
      font-weight: bold;
      font-size: 110%;
    }
    td.coverBar
    {
      padding-left: 10px;
      padding-right: 10px;
      background-color: LightBlue;
    }
    td.coverBarOutline
    {
      background-color: white;
    }
    td.coverValue
    {
      padding-top: 2px;
      text-align: right;
      padding-left: 10px;
      padding-right: 10px;
      font-family: sans-serif;
      white-space: nowrap;
      font-weight: bold;
    }
    
    /* Link Details */
    a.detail:link
    {
      color: #B8D0FF;
      font-size:80%;
    }
    a.detail:visited
    {
      color: #B8D0FF;
      font-size:80%;
    }
    a.detail:active
    {
      color: #FFFFFF;
      font-size:80%;
    }
    
    .graphcont{
        color:#000;
        font-weight:700;
        float:left
    }

    .graph{
        float:left;
        background-color: white;
        position:relative;
        width:280px;
        padding:0
    }

    .graph .bar{
        display:block;
        position:relative;
        border:black 1px solid;
        text-align:center;
        color:#fff;
        height:10px;
        font-family:Arial,Helvetica,sans-serif;
        font-size:12px;
        line-height:1.9em
    }

    .graph .bar span{
        position:absolute;
        left:1em
    } 

    td.coveredLine,
    span.coveredLine
    {
        background-color: LightGreen!important;
    }

    td.uncoveredLine,
    span.uncoveredLine
    {
        background-color: LightPink!important;
    }

    .linecount
    {
        border-right: 1px gray solid;
        background-color: lightgray;
    }

    .src 
    {
        padding-left: 12px;
    }

    .srcHeader
    {
        font-family: monospace; 
        font-weight: bold;
    }

    pre 
    {
        height : 15px;
        margin-top: 0;
        margin-bottom: 0;
    }

    .lineno
    {
        background-color: #EFE383;
        border-right: 1px solid #BBB15F;
    }

  </style>
</head>

<body>

  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr><td class="title">GCC Code Coverage Report</td></tr>
    <tr><td class="hr"></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding="1" border="0" width="100%">
          <tr>
            <td width="10%" class="headerName">Directory:</td>
            <td width="35%" class="headerValue">.</td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerValue" style="text-align:right;">Exec</td>
            <td width="10%" class="headerValue" style="text-align:right;">Total</td>
            <td width="15%" class="headerValue" style="text-align:right;">Coverage</td>
          </tr>
          <tr>
            <td class="headerName">File:</td>
            <td class="headerValue">gofmm/gofmm_mpi.hpp</td>
            <td></td>
            <td class="headerName">Lines:</td>
            <td class="headerTableEntry">0</td>
            <td class="headerTableEntry">1319</td>
            <td class="headerTableEntry" style="background-color:LightPink">0.0 %</td>
          </tr>
          <tr>
            <td class="headerName">Date:</td>
            <td class="headerValue">2019-01-14</td>
            <td></td>
            <td class="headerName">Branches:</td>
            <td class="headerTableEntry">0</td>
            <td class="headerTableEntry">7158</td>
            <td class="headerTableEntry" style="background-color:LightPink">0.0 %</td>
          </tr>
        </table>
      </td>
    </tr>

    <tr><td class="hr"></td></tr>
  </table>

  <br>
  <table cellspacing="0" cellpadding="1">
    <tr>
      <td width="5%" align="right" class="srcHeader">Line</td>
      <td width="10%" align="right" class="srcHeader">Exec</td>
      <td width="75%" align="left" class="srcHeader src">Source</td>
    </tr>

    
    <tr>
    <td align="right" class="lineno"><pre>1</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  HMLP (High-Performance Machine Learning Primitives)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  Copyright (C) 2014-2017, The University of Texas at Austin</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>6</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  This program is free software: you can redistribute it and/or modify</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>7</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  it under the terms of the GNU General Public License as published by</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>8</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  the Free Software Foundation, either version 3 of the License, or</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>9</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  (at your option) any later version.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>10</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>11</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  This program is distributed in the hope that it will be useful,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>12</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>13</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>14</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  GNU General Public License for more details.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>15</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>16</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  You should have received a copy of the GNU General Public License</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>17</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  along with this program. If not, see the LICENSE file.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>18</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>19</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> **/</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>20</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>21</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>22</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#ifndef GOFMM_MPI_HPP</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>23</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#define GOFMM_MPI_HPP</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>24</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>25</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/** Inherit most of the classes from shared-memory GOFMM. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>26</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#include &lt;gofmm.hpp&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>27</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/** Use distributed metric trees. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>28</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#include &lt;tree_mpi.hpp&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>29</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#include &lt;igofmm_mpi.hpp&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>30</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/** Use distributed matrices inspired by the Elemental notation. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>31</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//#include &lt;DistData.hpp&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>32</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/** Use STL and HMLP namespaces. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>33</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>using namespace std;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>34</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>using namespace hmlp;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>35</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>36</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>37</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>namespace hmlp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>38</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>39</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>namespace mpigofmm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>40</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>41</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>42</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>43</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>///**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>44</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>// *  @biref This class does not have to inherit DistData, but it have to</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>45</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>// *         inherit DistVirtualMatrix&lt;T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>46</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>// *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>47</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>// */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>48</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//template&lt;typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>49</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//class DistSPDMatrix : public DistData&lt;STAR, CBLK, T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>50</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>51</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//  public:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>52</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>53</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    DistSPDMatrix( size_t m, size_t n, mpi::Comm comm ) :</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>54</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      DistData&lt;STAR, CBLK, T&gt;( m, n, comm )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>55</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>56</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>57</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>58</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>59</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    /** ESSENTIAL: this is an abstract function  */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>60</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    virtual T operator()( size_t i, size_t j, mpi::Comm comm )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>61</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>62</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      T Kij = 0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>63</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>64</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      /** MPI */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>65</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      int size, rank;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>66</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      hmlp::mpi::Comm_size( comm, &amp;size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>67</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      hmlp::mpi::Comm_rank( comm, &amp;rank );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>68</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>69</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      std::vector&lt;std::vector&lt;size_t&gt;&gt; sendrids( size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>70</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      std::vector&lt;std::vector&lt;size_t&gt;&gt; recvrids( size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>71</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      std::vector&lt;std::vector&lt;size_t&gt;&gt; sendcids( size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>72</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      std::vector&lt;std::vector&lt;size_t&gt;&gt; recvcids( size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>73</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>74</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      /** request Kij from rank ( j % size ) */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>75</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      sendrids[ i % size ].push_back( i );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>76</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      sendcids[ j % size ].push_back( j );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>77</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>78</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      /** exchange ids */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>79</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      mpi::AlltoallVector( sendrids, recvrids, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>80</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      mpi::AlltoallVector( sendcids, recvcids, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>81</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>82</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      /** allocate buffer for data */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>83</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      std::vector&lt;std::vector&lt;T&gt;&gt; senddata( size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>84</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      std::vector&lt;std::vector&lt;T&gt;&gt; recvdata( size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>85</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>86</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      /** fetch subrows */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>87</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      for ( size_t p = 0; p &lt; size; p ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>88</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>89</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        assert( recvrids[ p ].size() == recvcids[ p ].size() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>90</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        for ( size_t j = 0; j &lt; recvcids[ p ].size(); j ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>91</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>92</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//          size_t rid = recvrids[ p ][ j ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>93</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//          size_t cid = recvcids[ p ][ j ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>94</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//          senddata[ p ].push_back( (*this)( rid, cid ) );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>95</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>96</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>97</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>98</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      /** exchange data */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>99</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      mpi::AlltoallVector( senddata, recvdata, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>100</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>101</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      for ( size_t p = 0; p &lt; size; p ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>102</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>103</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        assert( recvdata[ p ].size() &lt;= 1 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>104</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        if ( recvdata[ p ] ) Kij = recvdata[ p ][ 0 ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>105</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>106</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>107</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      return Kij;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>108</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>109</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>110</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>111</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    /** ESSENTIAL: return a submatrix */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>112</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    virtual hmlp::Data&lt;T&gt; operator()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>113</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//		( std::vector&lt;size_t&gt; &amp;imap, std::vector&lt;size_t&gt; &amp;jmap, hmlp::mpi::Comm comm )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>114</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>115</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      hmlp::Data&lt;T&gt; KIJ( imap.size(), jmap.size() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>116</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>117</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      /** MPI */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>118</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      int size, rank;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>119</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      hmlp::mpi::Comm_size( comm, &amp;size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>120</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      hmlp::mpi::Comm_rank( comm, &amp;rank );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>121</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>122</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>123</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>124</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      std::vector&lt;std::vector&lt;size_t&gt;&gt; jmapcids( size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>125</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>126</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      std::vector&lt;std::vector&lt;size_t&gt;&gt; sendrids( size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>127</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      std::vector&lt;std::vector&lt;size_t&gt;&gt; recvrids( size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>128</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      std::vector&lt;std::vector&lt;size_t&gt;&gt; sendcids( size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>129</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      std::vector&lt;std::vector&lt;size_t&gt;&gt; recvcids( size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>130</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>131</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      /** request KIJ from rank ( j % size ) */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>132</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      for ( size_t j = 0; j &lt; jmap.size(); j ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>133</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>134</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        size_t cid = jmap[ j ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>135</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        sendcids[ cid % size ].push_back( cid );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>136</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        jmapcids[ cid % size ].push_back(   j );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>137</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>138</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>139</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      for ( size_t p = 0; p &lt; size; p ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>140</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>141</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        if ( sendcids[ p ].size() ) sendrids[ p ] = imap;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>142</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>143</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>144</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      /** exchange ids */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>145</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      mpi::AlltoallVector( sendrids, recvrids, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>146</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      mpi::AlltoallVector( sendcids, recvcids, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>147</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>148</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      /** allocate buffer for data */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>149</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      std::vector&lt;hmlp::Data&lt;T&gt;&gt; senddata( size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>150</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      std::vector&lt;hmlp::Data&lt;T&gt;&gt; recvdata( size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>151</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>152</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      /** fetch submatrix */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>153</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      for ( size_t p = 0; p &lt; size; p ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>154</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>155</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        if ( recvcids[ p ].size() &amp;&amp; recvrids[ p ].size() )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>156</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>157</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//          senddata[ p ] = (*this)( recvrids[ p ], recvcids[ p ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>158</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>159</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>160</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>161</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      /** exchange data */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>162</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      mpi::AlltoallVector( senddata, recvdata, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>163</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>164</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      /** merging data */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>165</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      for ( size_t p = 0; j &lt; size; p ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>166</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>167</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        assert( recvdata[ p ].size() == imap.size() * recvcids[ p ].size() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>168</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        recvdata[ p ].resize( imap.size(), recvcids[ p ].size() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>169</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        for ( size_t j = 0; j &lt; recvcids[ p ]; i ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>170</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>171</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//          for ( size_t i = 0; i &lt; imap.size(); i ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>172</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//          {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>173</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//            KIJ( i, jmapcids[ p ][ j ] ) = recvdata[ p ]( i, j );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>174</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//          }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>175</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>176</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>177</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>178</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      return KIJ;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>179</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>180</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>181</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>182</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>183</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>184</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>185</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    virtual hmlp::Data&lt;T&gt; operator()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>186</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//		( std::vector&lt;int&gt; &amp;imap, std::vector&lt;int&gt; &amp;jmap, hmlp::mpi::Comm comm )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>187</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>188</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      printf( "operator() not implemented yet\n" );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>189</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      exit( 1 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>190</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>191</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>192</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>193</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>194</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    /** overload operator */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>195</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>196</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>197</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//  private:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>198</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>199</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//}; /** end class DistSPDMatrix */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>200</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>201</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>202</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>203</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>204</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>205</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  @brief These are data that shared by the whole local tree.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>206</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *         Distributed setup inherits mpitree::Setup.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>207</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>208</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename SPDMATRIX, typename SPLITTER, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>209</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>class Setup : public mpitree::Setup&lt;SPLITTER, T&gt;,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>210</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>              public gofmm::Configuration&lt;T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>211</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>212</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  public:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>213</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>214</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Shallow copy from the config. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>215</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    void FromConfiguration( gofmm::Configuration&lt;T&gt; &amp;config,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>216</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        SPDMATRIX &amp;K, SPLITTER &amp;splitter,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>217</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        DistData&lt;STAR, CBLK, pair&lt;T, size_t&gt;&gt;* NN_cblk )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>218</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>219</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      this-&gt;CopyFrom( config );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>220</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      this-&gt;K = &amp;K;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>221</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      this-&gt;splitter = splitter;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>222</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      this-&gt;NN_cblk = NN_cblk;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>223</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>224</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>225</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** The SPDMATRIX (accessed with gids: dense, CSC or OOC) */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>226</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    SPDMATRIX *K = NULL;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>227</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>228</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** rhs-by-n, all weights and potentials. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>229</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    Data&lt;T&gt; *w = NULL;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>230</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    Data&lt;T&gt; *u = NULL;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>231</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>232</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** buffer space, either dimension needs to be n  */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>233</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    Data&lt;T&gt; *input = NULL;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>234</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    Data&lt;T&gt; *output = NULL;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>235</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>236</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** regularization */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>237</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    T lambda = 0.0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>238</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>239</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** whether the matrix is symmetric */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>240</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //bool issymmetric = true;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>241</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>242</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** use ULV or Sherman-Morrison-Woodbury */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>243</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    bool do_ulv_factorization = true;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>244</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>245</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>246</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  private:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>247</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>248</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end class Setup */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>249</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>250</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>251</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>252</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>253</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>254</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>255</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  @brief This task creates an hierarchical tree view for</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>256</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *         weights&lt;RIDS&gt; and potentials&lt;RIDS&gt;.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>257</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>258</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename NODE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>259</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>class DistTreeViewTask : public Task</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>260</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>261</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  public:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>262</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>263</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    NODE *arg = NULL;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>264</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>265</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Set( NODE *user_arg )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>266</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>267</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      arg = user_arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>268</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      name = string( "TreeView" );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>269</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      label = to_string( arg-&gt;treelist_id );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>270</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      cost = 1.0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>271</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>272</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>273</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Preorder dependencies (with a single source node) */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>274</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void DependencyAnalysis() { arg-&gt;DependOnParent( this ); };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>275</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>276</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Execute( Worker* user_worker )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>277</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>278</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto *node   = arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>279</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>280</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** w and u can be Data&lt;T&gt; or DistData&lt;RIDS,STAR,T&gt; */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>281</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto &amp;w = *(node-&gt;setup-&gt;w);</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>282</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto &amp;u = *(node-&gt;setup-&gt;u);</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>283</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>284</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** get the matrix view of this tree node */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>285</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto &amp;U = node-&gt;data.u_view;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>286</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto &amp;W = node-&gt;data.w_view;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>287</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>288</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Both w and u are column-majored, thus nontranspose. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>289</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      U.Set( u );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>290</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      W.Set( w );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>291</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>292</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Create sub matrix views for local nodes. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>293</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      if ( !node-&gt;isleaf &amp;&amp; !node-&gt;child )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>294</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>295</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        assert( node-&gt;lchild &amp;&amp; node-&gt;rchild );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>296</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        auto &amp;UL = node-&gt;lchild-&gt;data.u_view;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>297</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        auto &amp;UR = node-&gt;rchild-&gt;data.u_view;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>298</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        auto &amp;WL = node-&gt;lchild-&gt;data.w_view;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>299</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        auto &amp;WR = node-&gt;rchild-&gt;data.w_view;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>300</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        /**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>301</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         *  U = [ UL;    W = [ WL;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>302</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         *        UR; ]        WR; ]</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>303</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>304</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        U.Partition2x1( UL,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>305</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                        UR, node-&gt;lchild-&gt;n, TOP );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>306</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        W.Partition2x1( WL,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>307</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                        WR, node-&gt;lchild-&gt;n, TOP );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>308</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>309</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>310</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>311</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end class DistTreeViewTask */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>312</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>313</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>314</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>315</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>316</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>317</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>318</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>319</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>320</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>321</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/** @brief Split values into two halfs accroding to the median. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>322</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>323</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>vector&lt;vector&lt;size_t&gt;&gt; DistMedianSplit( vector&lt;T&gt; &amp;values, mpi::Comm comm )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>324</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>325</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int n = 0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>326</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int num_points_owned = values.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>327</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** n = sum( num_points_owned ) over all MPI processes in comm */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>328</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  mpi::Allreduce( &amp;num_points_owned, &amp;n, 1, MPI_SUM, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>329</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  T  median = combinatorics::Select( n / 2, values, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>330</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>331</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  vector&lt;vector&lt;size_t&gt;&gt; split( 2 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>332</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  vector&lt;size_t&gt; middle;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>333</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>334</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  if ( n == 0 ) return split;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>335</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>336</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( size_t i = 0; i &lt; values.size(); i ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>337</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>338</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto v = values[ i ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>339</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( std::fabs( v - median ) &lt; 1E-6 ) middle.push_back( i );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>340</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    else if ( v &lt; median ) split[ 0 ].push_back( i );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>341</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    else split[ 1 ].push_back( i );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>342</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>343</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>344</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int nmid = 0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>345</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int nlhs = 0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>346</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int nrhs = 0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>347</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int num_mid_owned = middle.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>348</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int num_lhs_owned = split[ 0 ].size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>349</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int num_rhs_owned = split[ 1 ].size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>350</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>351</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** nmid = sum( num_mid_owned ) over all MPI processes in comm. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>352</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  mpi::Allreduce( &amp;num_mid_owned, &amp;nmid, 1, MPI_SUM, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>353</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  mpi::Allreduce( &amp;num_lhs_owned, &amp;nlhs, 1, MPI_SUM, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>354</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  mpi::Allreduce( &amp;num_rhs_owned, &amp;nrhs, 1, MPI_SUM, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>355</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>356</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Assign points in the middle to left or right. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>357</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  if ( nmid )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>358</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>359</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    int nlhs_required, nrhs_required;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>360</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>361</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( nlhs &gt; nrhs )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>362</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>363</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      nlhs_required = ( n - 1 ) / 2 + 1 - nlhs;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>364</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      nrhs_required = nmid - nlhs_required;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>365</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>366</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>367</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>368</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      nrhs_required = ( n - 1 ) / 2 + 1 - nrhs;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>369</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      nlhs_required = nmid - nrhs_required;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>370</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>371</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>372</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    assert( nlhs_required &gt;= 0 &amp;&amp; nrhs_required &gt;= 0 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>373</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>374</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Now decide the portion */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>375</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    double lhs_ratio = ( (double)nlhs_required ) / nmid;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>376</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    int nlhs_required_owned = num_mid_owned * lhs_ratio;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>377</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    int nrhs_required_owned = num_mid_owned - nlhs_required_owned;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>378</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>379</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //printf( "rank %d [ %d %d ] [ %d %d ]\n",</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>380</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //  global_rank,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>381</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //  nlhs_required_owned, nlhs_required,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>382</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //  nrhs_required_owned, nrhs_required ); fflush( stdout );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>383</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>384</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    assert( nlhs_required_owned &gt;= 0 &amp;&amp; nrhs_required_owned &gt;= 0 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>385</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>386</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    for ( size_t i = 0; i &lt; middle.size(); i ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>387</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>388</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      if ( i &lt; nlhs_required_owned )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>389</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        split[ 0 ].push_back( middle[ i ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>390</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>391</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        split[ 1 ].push_back( middle[ i ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>392</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>393</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>394</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>395</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  return split;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>396</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end MedianSplit() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>397</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>398</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>399</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>400</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>401</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>402</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  @brief This the main splitter used to build the Spd-Askit tree.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>403</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *         First compute the approximate center using subsamples.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>404</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *         Then find the two most far away points to do the</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>405</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *         projection.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>406</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>407</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename SPDMATRIX, int N_SPLIT, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>408</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>struct centersplit : public gofmm::centersplit&lt;SPDMATRIX, N_SPLIT, T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>409</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>410</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>411</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  centersplit() : gofmm::centersplit&lt;SPDMATRIX, N_SPLIT, T&gt;() {};</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>412</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>413</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  centersplit( SPDMATRIX&amp; K ) : gofmm::centersplit&lt;SPDMATRIX, N_SPLIT, T&gt;( K ) {};</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>414</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>415</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Shared-memory operator. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>416</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  inline vector&lt;vector&lt;size_t&gt; &gt; operator() ( vector&lt;size_t&gt;&amp; gids ) const</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>417</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>418</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    return gofmm::centersplit&lt;SPDMATRIX, N_SPLIT, T&gt;::operator() ( gids );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>419</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>420</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>421</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Distributed operator. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>422</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  inline vector&lt;vector&lt;size_t&gt; &gt; operator() ( vector&lt;size_t&gt;&amp; gids, mpi::Comm comm ) const</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>423</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>424</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** All assertions */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>425</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    assert( N_SPLIT == 2 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>426</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    assert( this-&gt;Kptr );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>427</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>428</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** MPI Support. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>429</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    int size; mpi::Comm_size( comm, &amp;size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>430</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    int rank; mpi::Comm_rank( comm, &amp;rank );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>431</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto &amp;K = *(this-&gt;Kptr);</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>432</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>433</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>434</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    vector&lt;T&gt; temp( gids.size(), 0.0 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>435</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>436</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Collecting column samples of K. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>437</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto column_samples = combinatorics::SampleWithoutReplacement(</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>438</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        this-&gt;n_centroid_samples, gids );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>439</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>440</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Bcast column_samples from rank 0. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>441</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpi::Bcast( column_samples.data(), column_samples.size(), 0, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>442</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    K.BcastIndices( column_samples, 0, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>443</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>444</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Compute all pairwise distances. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>445</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto DIC = K.Distances( this-&gt;metric, gids, column_samples );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>446</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>447</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Zero out the temporary buffer. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>448</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    for ( auto &amp; it : temp ) it = 0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>449</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>450</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Accumulate distances to the temporary buffer. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>451</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    for ( size_t j = 0; j &lt; DIC.col(); j ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>452</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( size_t i = 0; i &lt; DIC.row(); i ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>453</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        temp[ i ] += DIC( i, j );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>454</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>455</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Find the f2c (far most to center) from points owned */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>456</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    auto idf2c = distance( temp.begin(), max_element( temp.begin(), temp.end() ) );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>457</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>458</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Create a pair for MPI Allreduce */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>459</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    mpi::NumberIntPair&lt;T&gt; local_max_pair, max_pair;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>460</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    local_max_pair.val = temp[ idf2c ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>461</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    local_max_pair.key = rank;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>462</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>463</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** max_pair = max( local_max_pairs ) over all MPI processes in comm */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>464</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    mpi::Allreduce( &amp;local_max_pair, &amp;max_pair, 1, MPI_MAXLOC, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>465</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>466</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Boardcast gidf2c from the MPI process which has the max_pair */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>467</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    int gidf2c = gids[ idf2c ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>468</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpi::Bcast( &amp;gidf2c, 1, MPI_INT, max_pair.key, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>469</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>470</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>471</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //printf( "rank %d val %E key %d; global val %E key %d\n",</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>472</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //    rank, local_max_pair.val, local_max_pair.key,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>473</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //    max_pair.val, max_pair.key ); fflush( stdout );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>474</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //printf( "rank %d gidf2c %d\n", rank, gidf2c  ); fflush( stdout );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>475</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>476</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Collecting KIP and kpp */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>477</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    vector&lt;size_t&gt; P( 1, gidf2c );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>478</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    K.BcastIndices( P, max_pair.key, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>479</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>480</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Compute all pairwise distances. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>481</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto DIP = K.Distances( this-&gt;metric, gids, P );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>482</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>483</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Find f2f (far most to far most) from owned points */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>484</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    auto idf2f = distance( DIP.begin(), max_element( DIP.begin(), DIP.end() ) );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>485</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>486</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Create a pair for MPI Allreduce */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>487</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    local_max_pair.val = DIP[ idf2f ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>488</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    local_max_pair.key = rank;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>489</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>490</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** max_pair = max( local_max_pairs ) over all MPI processes in comm */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>491</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    mpi::Allreduce( &amp;local_max_pair, &amp;max_pair, 1, MPI_MAXLOC, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>492</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>493</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** boardcast gidf2f from the MPI process which has the max_pair */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>494</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    int gidf2f = gids[ idf2f ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>495</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpi::Bcast( &amp;gidf2f, 1, MPI_INT, max_pair.key, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>496</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>497</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //printf( "rank %d val %E key %d; global val %E key %d\n",</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>498</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //    rank, local_max_pair.val, local_max_pair.key,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>499</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //    max_pair.val, max_pair.key ); fflush( stdout );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>500</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //printf( "rank %d gidf2f %d\n", rank, gidf2f  ); fflush( stdout );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>501</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>502</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Collecting KIQ and kqq */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>503</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    vector&lt;size_t&gt; Q( 1, gidf2f );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>504</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    K.BcastIndices( Q, max_pair.key, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>505</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>506</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Compute all pairwise distances. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>507</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto DIQ = K.Distances( this-&gt;metric, gids, P );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>508</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>509</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** We use relative distances (dip - diq) for clustering. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>510</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    for ( size_t i = 0; i &lt; temp.size(); i ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>511</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      temp[ i ] = DIP[ i ] - DIQ[ i ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>512</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>513</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Split gids into two clusters using median split. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>514</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto split = DistMedianSplit( temp, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>515</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>516</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Perform P2P redistribution. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>517</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    mpi::Status status;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>518</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    vector&lt;size_t&gt; sent_gids;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>519</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    int partner = ( rank + size / 2 ) % size;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>520</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( rank &lt; size / 2 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>521</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>522</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( auto it : split[ 1 ] )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>523</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        sent_gids.push_back( gids[ it ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>524</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      K.SendIndices( sent_gids, partner, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>525</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      K.RecvIndices( partner, comm, &amp;status );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>526</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>527</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>528</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>529</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( auto it : split[ 0 ] )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>530</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        sent_gids.push_back( gids[ it ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>531</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      K.RecvIndices( partner, comm, &amp;status );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>532</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      K.SendIndices( sent_gids, partner, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>533</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>534</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>535</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    return split;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>536</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>537</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>538</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>539</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end struct centersplit */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>540</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>541</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>542</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>543</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>544</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>545</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename SPDMATRIX, int N_SPLIT, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>546</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>struct randomsplit : public gofmm::randomsplit&lt;SPDMATRIX, N_SPLIT, T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>547</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>548</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>549</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  randomsplit() : gofmm::randomsplit&lt;SPDMATRIX, N_SPLIT, T&gt;() {};</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>550</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>551</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  randomsplit( SPDMATRIX&amp; K ) : gofmm::randomsplit&lt;SPDMATRIX, N_SPLIT, T&gt;( K ) {};</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>552</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>553</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Shared-memory operator. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>554</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  inline vector&lt;vector&lt;size_t&gt; &gt; operator() ( vector&lt;size_t&gt;&amp; gids ) const</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>555</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>556</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    return gofmm::randomsplit&lt;SPDMATRIX, N_SPLIT, T&gt;::operator() ( gids );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>557</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>558</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>559</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Distributed operator. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>560</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  inline vector&lt;vector&lt;size_t&gt; &gt; operator() ( vector&lt;size_t&gt;&amp; gids, mpi::Comm comm ) const</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>561</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>562</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** All assertions */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>563</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    assert( N_SPLIT == 2 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>564</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    assert( this-&gt;Kptr );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>565</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>566</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Declaration */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>567</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    int size, rank, global_rank, global_size;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>568</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpi::Comm_size( comm, &amp;size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>569</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpi::Comm_rank( comm, &amp;rank );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>570</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpi::Comm_rank( MPI_COMM_WORLD, &amp;global_rank );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>571</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpi::Comm_size( MPI_COMM_WORLD, &amp;global_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>572</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    SPDMATRIX &amp;K = *(this-&gt;Kptr);</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>573</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //vector&lt;vector&lt;size_t&gt;&gt; split( N_SPLIT );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>574</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>575</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( size == global_size )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>576</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>577</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( size_t i = 0; i &lt; gids.size(); i ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>578</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        assert( gids[ i ] == i * size + rank );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>579</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>580</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>581</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>582</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>583</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>584</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Reduce to get the total size of gids. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>585</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    int n = 0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>586</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    int num_points_owned = gids.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>587</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    vector&lt;T&gt; temp( gids.size(), 0.0 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>588</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>589</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** n = sum( num_points_owned ) over all MPI processes in comm */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>590</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpi::Allreduce( &amp;num_points_owned, &amp;n, 1, MPI_INT, MPI_SUM, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>591</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>592</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Early return */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>593</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //if ( n == 0 ) return split;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>594</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>595</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Randomly select two points p and q */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>596</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    size_t gidf2c, gidf2f;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>597</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( gids.size() )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>598</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>599</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      gidf2c = gids[ std::rand() % gids.size() ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>600</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      gidf2f = gids[ std::rand() % gids.size() ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>601</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>602</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>603</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Create a pair &lt;gids.size(), rank&gt; for MPI Allreduce */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>604</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    mpi::NumberIntPair&lt;T&gt; local_max_pair, max_pair;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>605</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    local_max_pair.val = gids.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>606</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    local_max_pair.key = rank;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>607</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>608</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** max_pair = max( local_max_pairs ) over all MPI processes in comm */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>609</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    mpi::Allreduce( &amp;local_max_pair, &amp;max_pair, 1, MPI_MAXLOC, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>610</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>611</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Bcast gidf2c from the rank that has the most gids */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>612</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpi::Bcast( &amp;gidf2c, 1, max_pair.key, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>613</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    vector&lt;size_t&gt; P( 1, gidf2c );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>614</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    K.BcastIndices( P, max_pair.key, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>615</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>616</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Choose the second MPI rank */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>617</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( rank == max_pair.key ) local_max_pair.val = 0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>618</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>619</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** max_pair = max( local_max_pairs ) over all MPI processes in comm */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>620</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    mpi::Allreduce( &amp;local_max_pair, &amp;max_pair, 1, MPI_MAXLOC, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>621</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>622</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Bcast gidf2c from the rank that has the most gids */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>623</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpi::Bcast( &amp;gidf2f, 1, max_pair.key, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>624</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    vector&lt;size_t&gt; Q( 1, gidf2f );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>625</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    K.BcastIndices( Q, max_pair.key, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>626</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>627</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>628</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto DIP = K.Distances( this-&gt;metric, gids, P );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>629</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto DIQ = K.Distances( this-&gt;metric, gids, Q );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>630</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>631</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** We use relative distances (dip - diq) for clustering. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>632</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    for ( size_t i = 0; i &lt; temp.size(); i ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>633</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      temp[ i ] = DIP[ i ] - DIQ[ i ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>634</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>635</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Split gids into two clusters using median split. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>636</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto split = DistMedianSplit( temp, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>637</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>638</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Perform P2P redistribution. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>639</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    mpi::Status status;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>640</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    vector&lt;size_t&gt; sent_gids;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>641</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    int partner = ( rank + size / 2 ) % size;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>642</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( rank &lt; size / 2 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>643</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>644</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( auto it : split[ 1 ] )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>645</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        sent_gids.push_back( gids[ it ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>646</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      K.SendIndices( sent_gids, partner, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>647</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      K.RecvIndices( partner, comm, &amp;status );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>648</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>649</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>650</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>651</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( auto it : split[ 0 ] )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>652</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        sent_gids.push_back( gids[ it ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>653</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      K.RecvIndices( partner, comm, &amp;status );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>654</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      K.SendIndices( sent_gids, partner, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>655</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>656</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>657</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    return split;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>658</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>659</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>660</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>661</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end struct randomsplit */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>662</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>663</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>664</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>665</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>666</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>667</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>668</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>669</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>670</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>671</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>672</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>673</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>674</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>675</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>676</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>677</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>678</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>679</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>680</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>681</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>682</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>683</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>684</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  @brief Compute skeleton weights.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>685</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>686</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>687</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>688</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename NODE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>689</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void DistUpdateWeights( NODE *node )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>690</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>691</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Derive type T from NODE. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>692</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  using T = typename NODE::T;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>693</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** MPI Support. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>694</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  mpi::Status status;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>695</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  auto comm = node-&gt;GetComm();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>696</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  int  size = node-&gt;GetCommSize();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>697</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  int  rank = node-&gt;GetCommRank();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>698</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>699</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Early return if this is the root or there is no skeleton. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>700</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  if ( !node-&gt;parent || !node-&gt;data.isskel ) return;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>701</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>702</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  if ( size &lt; 2 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>703</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>704</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** This is the root of the local tree. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>705</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    gofmm::UpdateWeights( node );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>706</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>707</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>708</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>709</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Gather shared data and create reference. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>710</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto &amp;w = *node-&gt;setup-&gt;w;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>711</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    size_t nrhs = w.col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>712</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>713</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** gather per node data and create reference */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>714</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    auto &amp;data   = node-&gt;data;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>715</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto &amp;proj   = data.proj;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>716</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto &amp;w_skel = data.w_skel;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>717</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>718</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** This is the corresponding MPI rank. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>719</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( rank == 0 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>720</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>721</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      size_t s  = proj.row();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>722</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>			size_t sl = node-&gt;child-&gt;data.skels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>723</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>			size_t sr = proj.col() - sl;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>724</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** w_skel is s-by-nrhs, initial values are not important. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>725</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      w_skel.resize( s, nrhs );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>726</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Create matrix views. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>727</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      View&lt;T&gt; P( false,   proj ), PL, PR;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>728</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      View&lt;T&gt; W( false, w_skel ), WL( false, node-&gt;child-&gt;data.w_skel );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>729</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** P = [ PL, PR ] */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>730</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      P.Partition1x2( PL, PR, sl, LEFT );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>731</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** W  = PL * WL */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>732</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      gemm::xgemm&lt;GEMM_NB&gt;( (T)1.0, PL, WL, (T)0.0, W );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>733</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>734</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      Data&lt;T&gt; w_skel_sib;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>735</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      mpi::ExchangeVector( w_skel, size / 2, 0, w_skel_sib, size / 2, 0, comm, &amp;status );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>736</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>			/** Reduce from my sibling. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>737</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      #pragma omp parallel for</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>738</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>			for ( size_t i = 0; i &lt; w_skel.size(); i ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>739</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>				w_skel[ i ] += w_skel_sib[ i ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>740</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>741</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>742</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** The rank that holds the skeleton weight of the right child. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>743</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( rank == size / 2 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>744</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>745</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      size_t s  = proj.row();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>746</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>			size_t sr = node-&gt;child-&gt;data.skels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>747</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>			size_t sl = proj.col() - sr;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>748</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** w_skel is s-by-nrhs, initial values are not important. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>749</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      w_skel.resize( s, nrhs );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>750</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Create a transpose view proj_v */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>751</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      View&lt;T&gt; P( false,   proj ), PL, PR;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>752</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      View&lt;T&gt; W( false, w_skel ), WR( false, node-&gt;child-&gt;data.w_skel );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>753</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** P = [ PL, PR ] */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>754</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      P.Partition1x2( PL, PR, sl, LEFT );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>755</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** W += PR * WR */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>756</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      gemm::xgemm&lt;GEMM_NB&gt;( (T)1.0, PR, WR, (T)0.0, W );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>757</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>758</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>759</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>			Data&lt;T&gt; w_skel_sib;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>760</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>			mpi::ExchangeVector( w_skel, 0, 0, w_skel_sib, 0, 0, comm, &amp;status );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>761</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>			w_skel.clear();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>762</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>763</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>764</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end DistUpdateWeights() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>765</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>766</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>767</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>768</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>769</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>770</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  @brief Notice that NODE here is MPITree::Node.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>771</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>772</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename NODE, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>773</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>class DistUpdateWeightsTask : public Task</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>774</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>775</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  public:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>776</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>777</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    NODE *arg = NULL;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>778</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>779</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Set( NODE *user_arg )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>780</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>781</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      arg = user_arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>782</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      name = string( "DistN2S" );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>783</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      label = to_string( arg-&gt;treelist_id );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>784</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>785</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Compute FLOPS and MOPS */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>786</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      double flops = 0.0, mops = 0.0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>787</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto &amp;gids = arg-&gt;gids;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>788</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      auto &amp;skels = arg-&gt;data.skels;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>789</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto &amp;w = *arg-&gt;setup-&gt;w;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>790</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>791</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>			if ( !arg-&gt;child )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>792</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>			{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>793</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        if ( arg-&gt;isleaf )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>794</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>795</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto m = skels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>796</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto n = w.col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>797</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto k = gids.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>798</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          flops = 2.0 * m * n * k;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>799</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          mops = 2.0 * ( m * n + m * k + k * n );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>800</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>801</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>802</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>803</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          auto &amp;lskels = arg-&gt;lchild-&gt;data.skels;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>804</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          auto &amp;rskels = arg-&gt;rchild-&gt;data.skels;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>805</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto m = skels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>806</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto n = w.col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>807</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          auto k = lskels.size() + rskels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>808</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          flops = 2.0 * m * n * k;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>809</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          mops  = 2.0 * ( m * n + m * k + k * n );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>810</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>811</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>			}</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>812</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>			else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>813</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>			{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>814</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>				if ( arg-&gt;GetCommRank() == 0 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>815</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>				{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>816</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto &amp;lskels = arg-&gt;child-&gt;data.skels;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>817</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto m = skels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>818</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto n = w.col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>819</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto k = lskels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>820</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          flops = 2.0 * m * n * k;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>821</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          mops = 2.0 * ( m * n + m * k + k * n );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>822</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>				}</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>823</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>				if ( arg-&gt;GetCommRank() == arg-&gt;GetCommSize() / 2 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>824</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>				{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>825</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto &amp;rskels = arg-&gt;child-&gt;data.skels;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>826</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto m = skels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>827</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto n = w.col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>828</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto k = rskels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>829</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          flops = 2.0 * m * n * k;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>830</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          mops = 2.0 * ( m * n + m * k + k * n );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>831</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>				}</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>832</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>			}</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>833</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>834</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Setup the event */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>835</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      event.Set( label + name, flops, mops );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>836</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Assume computation bound */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>837</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      cost = flops / 1E+9;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>838</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** "HIGH" priority (critical path) */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>839</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      priority = true;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>840</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>841</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>842</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void DependencyAnalysis() { arg-&gt;DependOnChildren( this ); };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>843</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>844</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Execute( Worker* user_worker ) { DistUpdateWeights( arg ); };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>845</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>846</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end class DistUpdateWeightsTask */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>847</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>848</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>849</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>850</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>851</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>852</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>853</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>854</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//template&lt;bool NNPRUNE, typename NODE, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>855</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//class DistSkeletonsToSkeletonsTask : public Task</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>856</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>857</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//  public:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>858</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>859</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    NODE *arg = NULL;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>860</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>861</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    void Set( NODE *user_arg )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>862</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>863</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      arg = user_arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>864</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      name = string( "DistS2S" );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>865</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      label = to_string( arg-&gt;treelist_id );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>866</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      /** compute flops and mops */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>867</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      double flops = 0.0, mops = 0.0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>868</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      auto &amp;w = *arg-&gt;setup-&gt;w;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>869</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      size_t m = arg-&gt;data.skels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>870</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      size_t n = w.col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>871</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>872</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      auto *FarNodes = &amp;arg-&gt;FarNodes;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>873</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      if ( NNPRUNE ) FarNodes = &amp;arg-&gt;NNFarNodes;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>874</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>875</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      for ( auto it = FarNodes-&gt;begin(); it != FarNodes-&gt;end(); it ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>876</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>877</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        size_t k = (*it)-&gt;data.skels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>878</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        flops += 2.0 * m * n * k;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>879</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        mops  += m * k; // cost of Kab</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>880</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        mops  += 2.0 * ( m * n + n * k + k * n );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>881</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>882</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>883</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      /** setup the event */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>884</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      event.Set( label + name, flops, mops );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>885</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>886</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      /** assume computation bound */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>887</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      cost = flops / 1E+9;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>888</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>889</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      /** "LOW" priority */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>890</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      priority = false;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>891</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>892</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>893</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>894</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>895</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    void DependencyAnalysis()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>896</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>897</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      for ( auto p : arg-&gt;data.FarDependents )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>898</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        hmlp_msg_dependency_analysis( 306, p, R, this );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>899</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>900</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      auto *FarNodes = &amp;arg-&gt;FarNodes;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>901</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      if ( NNPRUNE ) FarNodes = &amp;arg-&gt;NNFarNodes;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>902</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      for ( auto it : *FarNodes ) it-&gt;DependencyAnalysis( R, this );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>903</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>904</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      arg-&gt;DependencyAnalysis( RW, this );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>905</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      this-&gt;TryEnqueue();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>906</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>907</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>908</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    /**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>909</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//     *  @brief Notice that S2S depends on all Far interactions, which</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>910</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//     *         may include local tree nodes or let nodes.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>911</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//     *         For HSS case, the only Far interaction is the sibling.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>912</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//     *         Skeleton weight of the sibling will always be exchanged</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>913</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//     *         by default in N2S. Thus, currently we do not need</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>914</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//     *         a distributed S2S, because the skeleton weight is already</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>915</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//     *         in place.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>916</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//     *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>917</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//     */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>918</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    void Execute( Worker* user_worker )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>919</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>920</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      auto *node = arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>921</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      /** MPI Support. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>922</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      auto comm = node-&gt;GetComm();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>923</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      auto size = node-&gt;GetCommSize();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>924</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      auto rank = node-&gt;GetCommRank();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>925</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>926</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      if ( size &lt; 2 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>927</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>928</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        gofmm::SkeletonsToSkeletons&lt;NNPRUNE, NODE, T&gt;( node );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>929</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>930</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>931</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>932</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        /** Only 0th rank (owner) will execute this task. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>933</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//        if ( rank == 0 ) gofmm::SkeletonsToSkeletons&lt;NNPRUNE, NODE, T&gt;( node );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>934</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>935</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>936</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>937</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//}; /** end class DistSkeletonsToSkeletonsTask */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>938</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>//</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>939</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>940</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename NODE, typename LETNODE, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>941</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>class S2STask2 : public Task</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>942</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>943</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  public:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>944</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>945</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    NODE *arg = NULL;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>946</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>947</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    vector&lt;LETNODE*&gt; Sources;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>948</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>949</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    int p = 0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>950</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>951</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    Lock *lock = NULL;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>952</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>953</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    int *num_arrived_subtasks;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>954</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>955</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Set( NODE *user_arg, vector&lt;LETNODE*&gt; user_src, int user_p, Lock *user_lock,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>956</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        int *user_num_arrived_subtasks )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>957</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>958</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      arg = user_arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>959</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      Sources = user_src;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>960</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      p = user_p;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>961</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      lock = user_lock;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>962</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      num_arrived_subtasks = user_num_arrived_subtasks;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>963</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      name = string( "S2S" );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>964</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      label = to_string( arg-&gt;treelist_id );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>965</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>966</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Compute FLOPS and MOPS */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>967</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      double flops = 0.0, mops = 0.0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>968</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      size_t nrhs = arg-&gt;setup-&gt;w-&gt;col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>969</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      size_t m = arg-&gt;data.skels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>970</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( auto src : Sources )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>971</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>972</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        size_t k = src-&gt;data.skels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>973</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        flops += 2 * m * k * nrhs;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>974</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        mops  += 2 * ( m * k + ( m + k ) * nrhs );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>975</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        flops += 2 * m * nrhs;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>976</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        flops += m * k * ( 2 * 18 + 100 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>977</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>978</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Setup the event */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>979</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      event.Set( label + name, flops, mops );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>980</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Assume computation bound */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>981</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      cost = flops / 1E+9;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>982</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Assume computation bound */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>983</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      if ( arg-&gt;treelist_id == 0 ) priority = true;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>984</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>985</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>986</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void DependencyAnalysis()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>987</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>988</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      if ( p == hmlp_get_mpi_rank() )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>989</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>990</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        for ( auto src : Sources ) src-&gt;DependencyAnalysis( R, this );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>991</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>992</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      else hmlp_msg_dependency_analysis( 306, p, R, this );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>993</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      this-&gt;TryEnqueue();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>994</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>995</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>996</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Execute( Worker* user_worker )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>997</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>998</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto *node = arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>999</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      if ( !node-&gt;parent || !node-&gt;data.isskel ) return;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1000</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      size_t nrhs = node-&gt;setup-&gt;w-&gt;col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1001</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto &amp;K = *node-&gt;setup-&gt;K;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1002</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto &amp;I = node-&gt;data.skels;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1003</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1004</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Temporary buffer */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1005</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      Data&lt;T&gt; u( I.size(), nrhs, 0.0 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1006</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1007</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( auto src : Sources )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1008</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1009</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        auto &amp;J = src-&gt;data.skels;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1010</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        auto &amp;w = src-&gt;data.w_skel;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1011</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        bool is_cached = true;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1012</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1013</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        auto &amp;KIJ = node-&gt;DistFar[ p ][ src-&gt;morton ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1014</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        if ( KIJ.row() != I.size() || KIJ.col() != J.size() )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1015</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1016</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          //printf( "KIJ %lu %lu I %lu J %lu\n", KIJ.row(), KIJ.col(), I.size(), J.size() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1017</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          KIJ = K( I, J );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1018</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          is_cached = false;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1019</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1020</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1021</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        assert( w.col() == nrhs );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1022</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        assert( w.row() == J.size() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1023</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        //xgemm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1024</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        //(</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1025</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        //  "N", "N", u.row(), u.col(), w.row(),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1026</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        //  1.0, KIJ.data(), KIJ.row(),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1027</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        //         w.data(),   w.row(),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1028</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        //  1.0,   u.data(),   u.row()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1029</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        //);</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1030</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        gemm::xgemm( (T)1.0, KIJ, w, (T)1.0, u );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1031</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1032</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        /** Free KIJ, if !is_cached. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1033</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        if ( !is_cached )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1034</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1035</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          KIJ.resize( 0, 0 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1036</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          KIJ.shrink_to_fit();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1037</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1038</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1039</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1040</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      lock-&gt;Acquire();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1041</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1042</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        auto &amp;u_skel = node-&gt;data.u_skel;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1043</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        for ( int i = 0; i &lt; u.size(); i ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1044</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          u_skel[ i ] += u[ i ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1045</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1046</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      lock-&gt;Release();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1047</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      #pragma omp atomic update</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1048</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      *num_arrived_subtasks += 1;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1049</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1050</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>};</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1051</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1052</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename NODE, typename LETNODE, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1053</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>class S2SReduceTask2 : public Task</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1054</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1055</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  public:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1056</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1057</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    NODE *arg = NULL;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1058</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1059</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    vector&lt;S2STask2&lt;NODE, LETNODE, T&gt;*&gt; subtasks;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1060</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1061</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    Lock lock;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1062</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1063</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    int num_arrived_subtasks = 0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1064</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1065</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    const size_t batch_size = 2;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1066</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1067</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Set( NODE *user_arg )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1068</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1069</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      arg = user_arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1070</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      name = string( "S2SR" );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1071</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      label = to_string( arg-&gt;treelist_id );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1072</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1073</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Reset u_skel */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1074</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      if ( arg )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1075</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1076</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        size_t nrhs = arg-&gt;setup-&gt;w-&gt;col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1077</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        auto &amp;I = arg-&gt;data.skels;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1078</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        arg-&gt;data.u_skel.resize( 0, 0 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1079</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        arg-&gt;data.u_skel.resize( I.size(), nrhs, 0 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1080</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1081</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1082</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Create subtasks */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1083</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( int p = 0; p &lt; hmlp_get_mpi_size(); p ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1084</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1085</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        vector&lt;LETNODE*&gt; Sources;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1086</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        for ( auto &amp;it : arg-&gt;DistFar[ p ] )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1087</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1088</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          Sources.push_back( (*arg-&gt;morton2node)[ it.first ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1089</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          if ( Sources.size() == batch_size )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1090</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1091</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>            subtasks.push_back( new S2STask2&lt;NODE, LETNODE, T&gt;() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1092</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>            subtasks.back()-&gt;Submit();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1093</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>            subtasks.back()-&gt;Set( user_arg, Sources, p, &amp;lock, &amp;num_arrived_subtasks );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1094</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>            subtasks.back()-&gt;DependencyAnalysis();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1095</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>            Sources.clear();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1096</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1097</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1098</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        if ( Sources.size() )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1099</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1100</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          subtasks.push_back( new S2STask2&lt;NODE, LETNODE, T&gt;() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1101</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          subtasks.back()-&gt;Submit();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1102</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          subtasks.back()-&gt;Set( user_arg, Sources, p, &amp;lock, &amp;num_arrived_subtasks );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1103</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          subtasks.back()-&gt;DependencyAnalysis();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1104</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          Sources.clear();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1105</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1106</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1107</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Compute FLOPS and MOPS. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1108</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      double flops = 0, mops = 0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1109</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Setup the event */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1110</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      event.Set( label + name, flops, mops );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1111</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Assume computation bound */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1112</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      priority = true;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1113</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1114</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1115</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void DependencyAnalysis()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1116</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1117</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( auto task : subtasks ) Scheduler::DependencyAdd( task, this );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1118</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      arg-&gt;DependencyAnalysis( RW, this );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1119</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      this-&gt;TryEnqueue();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1120</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1121</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1122</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Execute( Worker* user_worker )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1123</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1124</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Place holder */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1125</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      assert( num_arrived_subtasks == subtasks.size() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1126</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1127</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>};</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1128</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1129</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1130</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1131</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1132</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1133</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1134</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1135</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1136</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1137</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1138</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1139</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1140</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1141</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1142</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1143</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1144</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1145</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1146</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1147</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1148</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;bool NNPRUNE, typename NODE, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1149</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void DistSkeletonsToNodes( NODE *node )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1150</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1151</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** MPI Support. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1152</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  auto comm = node-&gt;GetComm();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1153</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  auto size = node-&gt;GetCommSize();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1154</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  auto rank = node-&gt;GetCommRank();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1155</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  mpi::Status status;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1156</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1157</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** gather shared data and create reference */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1158</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto &amp;K = *node-&gt;setup-&gt;K;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1159</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto &amp;w = *node-&gt;setup-&gt;w;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1160</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1161</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1162</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  size_t nrhs = w.col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1163</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1164</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1165</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Early return if this is the root or has no skeleton. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1166</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  if ( !node-&gt;parent || !node-&gt;data.isskel ) return;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1167</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1168</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  if ( size &lt; 2 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1169</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1170</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Call the shared-memory implementation. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1171</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    gofmm::SkeletonsToNodes( node );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1172</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1173</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1174</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1175</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    auto &amp;data = node-&gt;data;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1176</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto &amp;proj = data.proj;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1177</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto &amp;u_skel = data.u_skel;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1178</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1179</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( rank == 0 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1180</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1181</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>			size_t sl = node-&gt;child-&gt;data.skels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1182</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>			size_t sr = proj.col() - sl;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1183</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Send u_skel to my sibling. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1184</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      mpi::SendVector( u_skel, size / 2, 0, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1185</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Create a transpose matrix view for proj. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1186</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      View&lt;T&gt; P(  true,   proj ), PL, PR;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1187</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      View&lt;T&gt; U( false, u_skel ), UL( false, node-&gt;child-&gt;data.u_skel );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1188</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** P' = [ PL, PR ]' */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1189</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      P.Partition2x1( PL,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1190</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                      PR, sl, TOP );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1191</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** UL += PL' * U */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1192</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      gemm::xgemm&lt;GEMM_NB&gt;( (T)1.0, PL, U, (T)1.0, UL );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1193</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1194</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1195</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /**  */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1196</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( rank == size / 2 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1197</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1198</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      size_t s  = proj.row();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1199</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>			size_t sr = node-&gt;child-&gt;data.skels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1200</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      size_t sl = proj.col() - sr;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1201</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Receive u_skel from my sibling. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1202</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      mpi::RecvVector( u_skel, 0, 0, comm, &amp;status );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1203</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>			u_skel.resize( s, nrhs );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1204</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** create a transpose view proj_v */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1205</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      View&lt;T&gt; P(  true,   proj ), PL, PR;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1206</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      View&lt;T&gt; U( false, u_skel ), UR( false, node-&gt;child-&gt;data.u_skel );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1207</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** P' = [ PL, PR ]' */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1208</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      P.Partition2x1( PL,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1209</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                      PR, sl, TOP );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1210</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** UR += PR' * U */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1211</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      gemm::xgemm&lt;GEMM_NB&gt;( (T)1.0, PR, U, (T)1.0, UR );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1212</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1213</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1214</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end DistSkeletonsToNodes() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1215</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1216</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1217</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1218</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1219</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1220</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;bool NNPRUNE, typename NODE, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1221</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>class DistSkeletonsToNodesTask : public Task</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1222</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1223</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  public:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1224</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1225</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    NODE *arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1226</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1227</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Set( NODE *user_arg )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1228</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1229</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      arg = user_arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1230</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      name = string( "PS2N" );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1231</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      label = to_string( arg-&gt;l );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1232</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1233</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      double flops = 0.0, mops = 0.0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1234</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto &amp;gids = arg-&gt;gids;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1235</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      auto &amp;skels = arg-&gt;data.skels;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1236</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto &amp;w = *arg-&gt;setup-&gt;w;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1237</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1238</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>			if ( !arg-&gt;child )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1239</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>			{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1240</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        if ( arg-&gt;isleaf )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1241</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1242</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto m = skels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1243</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto n = w.col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1244</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto k = gids.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1245</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          flops = 2.0 * m * n * k;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1246</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          mops = 2.0 * ( m * n + m * k + k * n );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1247</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1248</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1249</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1250</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          auto &amp;lskels = arg-&gt;lchild-&gt;data.skels;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1251</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          auto &amp;rskels = arg-&gt;rchild-&gt;data.skels;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1252</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto m = skels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1253</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto n = w.col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1254</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          auto k = lskels.size() + rskels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1255</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          flops = 2.0 * m * n * k;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1256</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          mops  = 2.0 * ( m * n + m * k + k * n );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1257</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1258</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>			}</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1259</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>			else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1260</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>			{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1261</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>				if ( arg-&gt;GetCommRank() == 0 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1262</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>				{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1263</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto &amp;lskels = arg-&gt;child-&gt;data.skels;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1264</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto m = skels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1265</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto n = w.col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1266</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto k = lskels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1267</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          flops = 2.0 * m * n * k;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1268</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          mops = 2.0 * ( m * n + m * k + k * n );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1269</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>				}</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1270</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>				if ( arg-&gt;GetCommRank() == arg-&gt;GetCommSize() / 2 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1271</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>				{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1272</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto &amp;rskels = arg-&gt;child-&gt;data.skels;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1273</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto m = skels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1274</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto n = w.col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1275</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          auto k = rskels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1276</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          flops = 2.0 * m * n * k;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1277</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          mops = 2.0 * ( m * n + m * k + k * n );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1278</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>				}</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1279</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>			}</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1280</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1281</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Setup the event */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1282</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      event.Set( label + name, flops, mops );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1283</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Asuume computation bound */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1284</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      cost = flops / 1E+9;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1285</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** "HIGH" priority (critical path) */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1286</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      priority = true;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1287</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1288</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1289</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void DependencyAnalysis() { arg-&gt;DependOnParent( this ); };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1290</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1291</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Execute( Worker* user_worker ) { DistSkeletonsToNodes&lt;NNPRUNE, NODE, T&gt;( arg ); };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1292</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1293</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end class DistSkeletonsToNodesTask */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1294</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1295</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1296</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1297</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename NODE, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1298</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>class L2LTask2 : public Task</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1299</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1300</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  public:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1301</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1302</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    NODE *arg = NULL;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1303</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1304</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** A list of source node pointers. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1305</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    vector&lt;NODE*&gt; Sources;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1306</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1307</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    int p = 0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1308</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1309</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Write lock */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1310</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    Lock *lock = NULL;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1311</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1312</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    int *num_arrived_subtasks;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1313</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1314</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Set( NODE *user_arg, vector&lt;NODE*&gt; user_src, int user_p, Lock *user_lock,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1315</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        int* user_num_arrived_subtasks )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1316</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1317</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      arg = user_arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1318</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      Sources = user_src;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1319</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      p = user_p;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1320</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      lock = user_lock;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1321</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      num_arrived_subtasks = user_num_arrived_subtasks;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1322</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      name = string( "L2L" );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1323</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      label = to_string( arg-&gt;treelist_id );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1324</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1325</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Compute FLOPS and MOPS. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1326</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      double flops = 0.0, mops = 0.0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1327</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      size_t nrhs = arg-&gt;setup-&gt;w-&gt;col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1328</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      size_t m = arg-&gt;gids.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1329</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( auto src : Sources )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1330</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1331</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        size_t k = src-&gt;gids.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1332</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        flops += 2 * m * k * nrhs;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1333</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        mops  += 2 * ( m * k + ( m + k ) * nrhs );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1334</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        flops += 2 * m * nrhs;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1335</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        flops += m * k * ( 2 * 18 + 100 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1336</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1337</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Setup the event */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1338</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      event.Set( label + name, flops, mops );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1339</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Assume computation bound */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1340</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      cost = flops / 1E+9;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1341</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** "LOW" priority */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1342</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      priority = false;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1343</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1344</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1345</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void DependencyAnalysis()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1346</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1347</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** If p is a distributed process, then depends on the message. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1348</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      if ( p != hmlp_get_mpi_rank() )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1349</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        hmlp_msg_dependency_analysis( 300, p, R, this );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1350</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      this-&gt;TryEnqueue();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1351</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1352</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1353</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Execute( Worker* user_worker )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1354</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1355</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto *node = arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1356</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      size_t nrhs = node-&gt;setup-&gt;w-&gt;col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1357</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto &amp;K = *node-&gt;setup-&gt;K;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1358</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto &amp;I = node-&gt;gids;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1359</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1360</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      double beg = omp_get_wtime();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1361</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Temporary buffer */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1362</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      Data&lt;T&gt; u( I.size(), nrhs, 0.0 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1363</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      size_t k;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1364</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1365</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( auto src : Sources )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1366</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1367</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        /** Get W view of this treenode. (available for non-LET nodes) */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1368</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        View&lt;T&gt; &amp;W = src-&gt;data.w_view;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1369</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        Data&lt;T&gt; &amp;w = src-&gt;data.w_leaf;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1370</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1371</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        bool is_cached = true;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1372</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        auto &amp;J = src-&gt;gids;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1373</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        auto &amp;KIJ = node-&gt;DistNear[ p ][ src-&gt;morton ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1374</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        if ( KIJ.row() != I.size() || KIJ.col() != J.size() )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1375</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1376</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          KIJ = K( I, J );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1377</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          is_cached = false;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1378</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1379</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1380</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        if ( W.col() == nrhs &amp;&amp; W.row() == J.size() )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1381</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1382</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          k += W.row();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1383</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          xgemm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1384</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          (</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1385</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>            "N", "N", u.row(), u.col(), W.row(),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1386</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>            1.0, KIJ.data(), KIJ.row(),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1387</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   W.data(),   W.ld(),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1388</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>            1.0,   u.data(),   u.row()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1389</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1390</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1391</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1392</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1393</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          k += w.row();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1394</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          xgemm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1395</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          (</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1396</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>            "N", "N", u.row(), u.col(), w.row(),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1397</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>            1.0, KIJ.data(), KIJ.row(),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1398</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   w.data(),   w.row(),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1399</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>            1.0,   u.data(),   u.row()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1400</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1401</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1402</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1403</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        /** Free KIJ, if !is_cached. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1404</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        if ( !is_cached )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1405</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1406</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          KIJ.resize( 0, 0 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1407</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          KIJ.shrink_to_fit();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1408</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1409</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1410</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1411</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      double lock_beg = omp_get_wtime();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1412</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      lock-&gt;Acquire();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1413</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1414</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        /** Get U view of this treenode. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1415</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        View&lt;T&gt; &amp;U = node-&gt;data.u_view;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1416</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        for ( int j = 0; j &lt; u.col(); j ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1417</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          for ( int i = 0; i &lt; u.row(); i ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1418</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>            U( i, j ) += u( i, j );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1419</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1420</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      lock-&gt;Release();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1421</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      double lock_time = omp_get_wtime() - lock_beg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1422</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1423</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      double gemm_time = omp_get_wtime() - beg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1424</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      double GFLOPS = 2.0 * u.row() * u.col() * k / ( 1E+9 * gemm_time );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1425</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //printf( "GEMM %4lu %4lu %4lu %lf GFLOPS, lock(%lf/%lf)\n",</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1426</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //    u.row(), u.col(), k, GFLOPS, lock_time, gemm_time ); fflush( stdout );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1427</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      #pragma omp atomic update</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1428</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      *num_arrived_subtasks += 1;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1429</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1430</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>};</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1431</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1432</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1433</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1434</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1435</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename NODE, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1436</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>class L2LReduceTask2 : public Task</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1437</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1438</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  public:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1439</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1440</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    NODE *arg = NULL;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1441</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1442</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    vector&lt;L2LTask2&lt;NODE, T&gt;*&gt; subtasks;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1443</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1444</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    Lock lock;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1445</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1446</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    int num_arrived_subtasks = 0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1447</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1448</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    const size_t batch_size = 2;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1449</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1450</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Set( NODE *user_arg )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1451</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1452</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      arg = user_arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1453</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      name = string( "L2LR" );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1454</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      label = to_string( arg-&gt;treelist_id );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1455</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Create subtasks */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1456</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( int p = 0; p &lt; hmlp_get_mpi_size(); p ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1457</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1458</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        vector&lt;NODE*&gt; Sources;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1459</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        for ( auto &amp;it : arg-&gt;DistNear[ p ] )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1460</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1461</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          Sources.push_back( (*arg-&gt;morton2node)[ it.first ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1462</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          if ( Sources.size() == batch_size )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1463</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1464</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>            subtasks.push_back( new L2LTask2&lt;NODE, T&gt;() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1465</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>            subtasks.back()-&gt;Submit();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1466</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>            subtasks.back()-&gt;Set( user_arg, Sources, p, &amp;lock, &amp;num_arrived_subtasks );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1467</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>            subtasks.back()-&gt;DependencyAnalysis();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1468</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>            Sources.clear();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1469</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1470</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1471</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        if ( Sources.size() )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1472</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1473</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          subtasks.push_back( new L2LTask2&lt;NODE, T&gt;() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1474</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          subtasks.back()-&gt;Submit();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1475</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          subtasks.back()-&gt;Set( user_arg, Sources, p, &amp;lock, &amp;num_arrived_subtasks );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1476</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          subtasks.back()-&gt;DependencyAnalysis();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1477</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          Sources.clear();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1478</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1479</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1480</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1481</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1482</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1483</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1484</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Compute FLOPS and MOPS */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1485</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      double flops = 0, mops = 0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1486</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Setup the event */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1487</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      event.Set( label + name, flops, mops );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1488</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** "LOW" priority (critical path) */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1489</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      priority = false;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1490</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1491</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1492</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void DependencyAnalysis()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1493</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1494</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( auto task : subtasks ) Scheduler::DependencyAdd( task, this );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1495</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      arg-&gt;DependencyAnalysis( RW, this );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1496</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      this-&gt;TryEnqueue();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1497</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1498</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1499</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Execute( Worker* user_worker )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1500</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1501</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      assert( num_arrived_subtasks == subtasks.size() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1502</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1503</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>};</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1504</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1505</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1506</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1507</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1508</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1509</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1510</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1511</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1512</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1513</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1514</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1515</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1516</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1517</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1518</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1519</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1520</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1521</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1522</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  @brief (FMM specific) Compute Near( leaf nodes ). This is just like</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1523</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *         the neighbor list but the granularity is in nodes but not points.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1524</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *         The algorithm is to compute the node morton ids of neighbor points.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1525</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *         Get the pointers of these nodes and insert them into a std::set.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1526</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *         std::set will automatic remove duplication. Here the insertion</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1527</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *         will be performed twice each time to get a symmetric one. That is</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1528</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *         if alpha has beta in its list, then beta will also have alpha in</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1529</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *         its list.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1530</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1531</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *         Only leaf nodes will have the list `` NearNodes''.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1532</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1533</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *         This list will later be used to get the FarNodes using a recursive</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1534</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *         node traversal scheme.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1535</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1536</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1537</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename TREE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1538</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void FindNearInteractions( TREE &amp;tree )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1539</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1540</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  mpi::PrintProgress( "[BEG] Finish FindNearInteractions ...", tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1541</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Derive type NODE from TREE. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1542</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  using NODE = typename TREE::NODE;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1543</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  auto &amp;setup = tree.setup;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1544</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  auto &amp;NN = *setup.NN;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1545</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  double budget = setup.Budget();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1546</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  size_t n_leafs = ( 1 &lt;&lt; tree.depth );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1547</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1548</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>   *  The type here is tree::Node but not mpitree::Node.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1549</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>   *  NearNodes and NNNearNodes also take tree::Node.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1550</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>   *  This is ok, because they will only contain leaf nodes,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1551</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>   *  which will never be distributed.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1552</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>   *  However, FarNodes and NNFarNodes may contain distributed</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1553</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>   *  tree nodes. In this case, we have to do type casting.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1554</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>   */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1555</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto level_beg = tree.treelist.begin() + n_leafs - 1;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1556</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1557</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Traverse all leaf nodes. **/</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1558</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  #pragma omp parallel for</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1559</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  for ( size_t node_ind = 0; node_ind &lt; n_leafs; node_ind ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1560</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1561</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto *node = *(level_beg + node_ind);</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1562</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    auto &amp;data = node-&gt;data;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1563</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    size_t n_nodes = ( 1 &lt;&lt; node-&gt;l );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1564</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1565</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Add myself to the near interaction list.  */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1566</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    node-&gt;NNNearNodes.insert( node );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1567</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    node-&gt;NNNearNodeMortonIDs.insert( node-&gt;morton );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1568</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1569</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Compute ballots for all near interactions */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1570</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    multimap&lt;size_t, size_t&gt; sorted_ballot = gofmm::NearNodeBallots( node );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1571</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1572</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Insert near node cadidates until reaching the budget limit. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1573</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    for ( auto it  = sorted_ballot.rbegin();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1574</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               it != sorted_ballot.rend(); it ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1575</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1576</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Exit if we have enough near interactions. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1577</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      if ( node-&gt;NNNearNodes.size() &gt;= n_nodes * budget ) break;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1578</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1579</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1580</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       *  Get the node pointer from MortonID.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1581</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1582</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       *  Two situations:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1583</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       *  1. the pointer doesn't exist, then creates a lettreenode</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1584</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1585</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      #pragma omp critical</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1586</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1587</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        if ( !(*node-&gt;morton2node).count( (*it).second ) )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1588</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1589</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          /** Create a LET node. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1590</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          (*node-&gt;morton2node)[ (*it).second ] = new NODE( (*it).second );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1591</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1592</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        /** Insert */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1593</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        auto *target = (*node-&gt;morton2node)[ (*it).second ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1594</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        node-&gt;NNNearNodeMortonIDs.insert( (*it).second );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1595</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        node-&gt;NNNearNodes.insert( target );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1596</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      } /** end pragma omp critical */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1597</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1598</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  } /** end for each leaf owned leaf node in the local tree */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1599</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  mpi::PrintProgress( "[END] Finish FindNearInteractions ...", tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1600</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>}; /** end FindNearInteractions() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1601</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1602</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1603</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1604</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1605</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename NODE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1606</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void FindFarNodes( MortonHelper::Recursor r, NODE *target )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1607</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1608</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Return while reaching the leaf level (recursion base case). */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1609</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  if ( r.second &gt; target-&gt;l ) return;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1610</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Compute the MortonID of the visiting node. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1611</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  size_t node_morton = MortonHelper::MortonID( r );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1612</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1613</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //bool prunable = true;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1614</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto &amp; NearMortonIDs = target-&gt;NNNearNodeMortonIDs;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1615</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1616</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Recur to children if the current node contains near interactions. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1617</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  if ( MortonHelper::ContainAny( node_morton, NearMortonIDs ) )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1618</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1619</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    FindFarNodes( MortonHelper::RecurLeft( r ), target );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1620</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    FindFarNodes( MortonHelper::RecurRight( r ), target );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1621</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1622</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1623</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1624</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( node_morton &gt;= target-&gt;morton )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1625</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      target-&gt;NNFarNodeMortonIDs.insert( node_morton );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1626</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1627</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end FindFarNodes() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1628</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1629</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1630</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1631</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1632</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1633</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1634</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename TREE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1635</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void SymmetrizeNearInteractions( TREE &amp; tree )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1636</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1637</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  mpi::PrintProgress( "[BEG] SymmetrizeNearInteractions ...", tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1638</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1639</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Derive type NODE from TREE. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1640</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  using NODE = typename TREE::NODE;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1641</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** MPI Support */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1642</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int comm_size; mpi::Comm_size( tree.GetComm(), &amp;comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1643</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int comm_rank; mpi::Comm_rank( tree.GetComm(), &amp;comm_rank );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1644</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1645</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  vector&lt;vector&lt;pair&lt;size_t, size_t&gt;&gt;&gt; sendlist( comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1646</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  vector&lt;vector&lt;pair&lt;size_t, size_t&gt;&gt;&gt; recvlist( comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1647</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1648</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1649</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1650</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>   *  Traverse local leaf nodes:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1651</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>   *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1652</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>   *  Loop over all near node MortonIDs, create</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1653</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>   *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1654</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>   */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1655</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int n_nodes = 1 &lt;&lt; tree.depth;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1656</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto level_beg = tree.treelist.begin() + n_nodes - 1;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1657</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1658</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  #pragma omp parallel</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1659</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1660</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Create a per thread list. Merge them into sendlist afterward. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1661</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    vector&lt;vector&lt;pair&lt;size_t, size_t&gt;&gt;&gt; list( comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1662</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1663</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    #pragma omp for</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1664</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    for ( int node_ind = 0; node_ind &lt; n_nodes; node_ind ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1665</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1666</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto *node = *(level_beg + node_ind);</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1667</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //auto &amp; NearMortonIDs = node-&gt;NNNearNodeMortonIDs;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1668</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( auto it : node-&gt;NNNearNodeMortonIDs )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1669</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1670</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        int dest = tree.Morton2Rank( it );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1671</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        if ( dest &gt;= comm_size ) printf( "%8lu dest %d\n", it, dest );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1672</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        list[ dest ].push_back( make_pair( it, node-&gt;morton ) );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1673</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1674</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    } /** end pramga omp for */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1675</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1676</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    #pragma omp critical</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1677</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1678</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( int p = 0; p &lt; comm_size; p ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1679</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1680</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        sendlist[ p ].insert( sendlist[ p ].end(),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1681</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>            list[ p ].begin(), list[ p ].end() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1682</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1683</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    } /** end pragma omp critical*/</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1684</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }; /** end pargma omp parallel */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1685</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1686</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1687</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Alltoallv */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1688</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  mpi::AlltoallVector( sendlist, recvlist, tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1689</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1690</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1691</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Loop over queries. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1692</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( int p = 0; p &lt; comm_size; p ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1693</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1694</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    for ( auto &amp; query : recvlist[ p ]  )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1695</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1696</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Check if query node is allocated? */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1697</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      #pragma omp critical</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1698</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1699</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        auto* node = tree.morton2node[ query.first ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1700</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        if ( !tree.morton2node.count( query.second ) )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1701</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1702</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          tree.morton2node[ query.second ] = new NODE( query.second );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1703</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1704</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        node-&gt;data.lock.Acquire();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1705</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1706</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          node-&gt;NNNearNodes.insert( tree.morton2node[ query.second ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1707</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          node-&gt;NNNearNodeMortonIDs.insert( query.second );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1708</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1709</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        node-&gt;data.lock.Release();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1710</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1711</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }; /** end pargma omp parallel for */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1712</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1713</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  mpi::Barrier( tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1714</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  mpi::PrintProgress( "[END] SymmetrizeNearInteractions ...", tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1715</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>}; /** end SymmetrizeNearInteractions() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1716</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1717</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1718</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename TREE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1719</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void SymmetrizeFarInteractions( TREE &amp; tree )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1720</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1721</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  mpi::PrintProgress( "[BEG] SymmetrizeFarInteractions ...", tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1722</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1723</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Derive type NODE from TREE. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1724</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  using NODE = typename TREE::NODE;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1725</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  ///** MPI Support. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1726</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //int comm_size; mpi::Comm_size( tree.GetComm(), &amp;comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1727</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //int comm_rank; mpi::Comm_rank( tree.GetComm(), &amp;comm_rank );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1728</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1729</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  vector&lt;vector&lt;pair&lt;size_t, size_t&gt;&gt;&gt; sendlist( tree.GetCommSize() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1730</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  vector&lt;vector&lt;pair&lt;size_t, size_t&gt;&gt;&gt; recvlist( tree.GetCommSize() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1731</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1732</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Local traversal */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1733</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  #pragma omp parallel</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1734</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1735</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Create a per thread list. Merge them into sendlist afterward. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1736</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    vector&lt;vector&lt;pair&lt;size_t, size_t&gt;&gt;&gt; list( tree.GetCommSize() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1737</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1738</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    #pragma omp for</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1739</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    for ( size_t i = 1; i &lt; tree.treelist.size(); i ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1740</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1741</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto *node = tree.treelist[ i ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1742</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      for ( auto it  = node-&gt;NNFarNodeMortonIDs.begin();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1743</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 it != node-&gt;NNFarNodeMortonIDs.end(); it ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1744</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1745</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        /** Allocate if not exist */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1746</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        #pragma omp critical</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1747</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1748</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          if ( !tree.morton2node.count( *it ) )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1749</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1750</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>            tree.morton2node[ *it ] = new NODE( *it );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1751</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1752</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          node-&gt;NNFarNodes.insert( tree.morton2node[ *it ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1753</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1754</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        int dest = tree.Morton2Rank( *it );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1755</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        if ( dest &gt;= tree.GetCommSize() ) printf( "%8lu dest %d\n", *it, dest );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1756</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        list[ dest ].push_back( make_pair( *it, node-&gt;morton ) );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1757</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1758</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1759</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1760</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    #pragma omp critical</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1761</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1762</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( int p = 0; p &lt; tree.GetCommSize(); p ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1763</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1764</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        sendlist[ p ].insert( sendlist[ p ].end(),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1765</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>            list[ p ].begin(), list[ p ].end() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1766</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1767</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    } /** end pragma omp critical*/</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1768</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1769</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1770</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1771</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Distributed traversal */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1772</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  #pragma omp parallel</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1773</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1774</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Create a per thread list. Merge them into sendlist afterward. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1775</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    vector&lt;vector&lt;pair&lt;size_t, size_t&gt;&gt;&gt; list( tree.GetCommSize() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1776</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1777</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    #pragma omp for</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1778</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    for ( size_t i = 0; i &lt; tree.mpitreelists.size(); i ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1779</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1780</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto *node = tree.mpitreelists[ i ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1781</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      for ( auto it  = node-&gt;NNFarNodeMortonIDs.begin();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1782</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 it != node-&gt;NNFarNodeMortonIDs.end(); it ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1783</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1784</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        /** Allocate if not exist */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1785</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        #pragma omp critical</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1786</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1787</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          if ( !tree.morton2node.count( *it ) )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1788</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1789</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>            tree.morton2node[ *it ] = new NODE( *it );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1790</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1791</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          node-&gt;NNFarNodes.insert( tree.morton2node[ *it ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1792</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1793</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        int dest = tree.Morton2Rank( *it );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1794</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        if ( dest &gt;= tree.GetCommSize() ) printf( "%8lu dest %d\n", *it, dest ); fflush( stdout );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1795</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        list[ dest ].push_back( make_pair( *it, node-&gt;morton ) );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1796</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1797</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1798</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1799</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    #pragma omp critical</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1800</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1801</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( int p = 0; p &lt; tree.GetCommSize(); p ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1802</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1803</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        sendlist[ p ].insert( sendlist[ p ].end(),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1804</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>            list[ p ].begin(), list[ p ].end() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1805</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1806</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    } /** end pragma omp critical*/</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1807</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1808</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1809</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Alltoallv */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1810</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  mpi::AlltoallVector( sendlist, recvlist, tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1811</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1812</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Loop over queries */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1813</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( int p = 0; p &lt; tree.GetCommSize(); p ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1814</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1815</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //#pragma omp parallel for</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1816</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    for ( auto &amp; query : recvlist[ p ] )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1817</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1818</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Check if query node is allocated?  */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1819</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      #pragma omp critical</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1820</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1821</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        if ( !tree.morton2node.count( query.second ) )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1822</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1823</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          tree.morton2node[ query.second ] = new NODE( query.second );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1824</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          //printf( "rank %d, %8lu level %lu creates far LET %8lu (symmetrize)\n",</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1825</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          //    comm_rank, node-&gt;morton, node-&gt;l, query.second );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1826</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1827</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        auto* node = tree.morton2node[ query.first ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1828</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        node-&gt;data.lock.Acquire();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1829</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1830</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          node-&gt;NNFarNodes.insert( tree.morton2node[ query.second ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1831</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          node-&gt;NNFarNodeMortonIDs.insert( query.second );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1832</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1833</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        node-&gt;data.lock.Release();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1834</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        assert( tree.Morton2Rank( node-&gt;morton ) == tree.GetCommRank() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1835</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      } /** end pragma omp critical */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1836</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    } /** end pargma omp parallel for */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1837</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1838</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1839</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  mpi::Barrier( tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1840</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  mpi::PrintProgress( "[END] SymmetrizeFarInteractions ...", tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1841</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>}; /** end SymmetrizeFarInteractions() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1842</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1843</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1844</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1845</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1846</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  TODO: need send and recv interaction lists for each rank</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1847</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1848</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  SendNNNear[ rank ][ local  morton ]</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1849</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  RecvNNNear[ rank ][ remote morton ]</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1850</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1851</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  for each leaf alpha and beta in Near(alpha)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1852</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *    SendNNNear[ rank(beta) ] += Morton(alpha)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1853</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1854</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  Alltoallv( SendNNNear, rbuff );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1855</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1856</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  for each rank</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1857</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *    RecvNNNear[ rank ][ remote morton ] = offset in rbuff</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1858</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1859</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1860</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename TREE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1861</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void BuildInteractionListPerRank( TREE &amp;tree, bool is_near )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1862</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1863</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Derive type T from TREE. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1864</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  using T = typename TREE::T;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1865</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** MPI Support. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1866</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int comm_size; mpi::Comm_size( tree.GetComm(), &amp;comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1867</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int comm_rank; mpi::Comm_rank( tree.GetComm(), &amp;comm_rank );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1868</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1869</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Interaction set per rank in MortonID. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1870</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  vector&lt;set&lt;size_t&gt;&gt; lists( comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1871</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1872</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  if ( is_near )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1873</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1874</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Traverse leaf nodes (near interation lists) */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1875</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    int n_nodes = 1 &lt;&lt; tree.depth;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1876</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto level_beg = tree.treelist.begin() + n_nodes - 1;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1877</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1878</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    #pragma omp parallel</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1879</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1880</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Create a per thread list. Merge them into sendlist afterward. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1881</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      vector&lt;set&lt;size_t&gt;&gt; list( comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1882</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1883</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      #pragma omp for</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1884</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      for ( int node_ind = 0; node_ind &lt; n_nodes; node_ind ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1885</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1886</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        auto *node = *(level_beg + node_ind);</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1887</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        auto &amp; NearMortonIDs = node-&gt;NNNearNodeMortonIDs;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1888</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        node-&gt;DistNear.resize( comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1889</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        for ( auto it : NearMortonIDs )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1890</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1891</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          int dest = tree.Morton2Rank( it );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1892</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          if ( dest &gt;= comm_size ) printf( "%8lu dest %d\n", it, dest );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1893</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          if ( dest != comm_rank ) list[ dest ].insert( node-&gt;morton );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1894</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          node-&gt;DistNear[ dest ][ it ] = Data&lt;T&gt;();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1895</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1896</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      } /** end pramga omp for */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1897</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1898</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      #pragma omp critical</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1899</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1900</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        for ( int p = 0; p &lt; comm_size; p ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1901</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          lists[ p ].insert( list[ p ].begin(), list[ p ].end() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1902</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      } /** end pragma omp critical*/</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1903</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }; /** end pargma omp parallel */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1904</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1905</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1906</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Cast set to vector. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1907</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    vector&lt;vector&lt;size_t&gt;&gt; recvlist( comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1908</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( !tree.NearSentToRank.size() ) tree.NearSentToRank.resize( comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1909</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( !tree.NearRecvFromRank.size() ) tree.NearRecvFromRank.resize( comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1910</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    #pragma omp parallel for</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1911</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    for ( int p = 0; p &lt; comm_size; p ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1912</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1913</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      tree.NearSentToRank[ p ].insert( tree.NearSentToRank[ p ].end(),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1914</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          lists[ p ].begin(), lists[ p ].end() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1915</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1916</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1917</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Use buffer recvlist to catch Alltoallv results. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1918</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpi::AlltoallVector( tree.NearSentToRank, recvlist, tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1919</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1920</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Cast vector of vectors to vector of maps */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1921</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    #pragma omp parallel for</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1922</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    for ( int p = 0; p &lt; comm_size; p ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1923</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( int i = 0; i &lt; recvlist[ p ].size(); i ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1924</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        tree.NearRecvFromRank[ p ][ recvlist[ p ][ i ] ] = i;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1925</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1926</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1927</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1928</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    #pragma omp parallel</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1929</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1930</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Create a per thread list. Merge them into sendlist afterward. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1931</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      vector&lt;set&lt;size_t&gt;&gt; list( comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1932</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1933</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Local traversal */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1934</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      #pragma omp for</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1935</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( size_t i = 1; i &lt; tree.treelist.size(); i ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1936</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1937</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        auto *node = tree.treelist[ i ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1938</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        node-&gt;DistFar.resize( comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1939</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        for ( auto it  = node-&gt;NNFarNodeMortonIDs.begin();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1940</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   it != node-&gt;NNFarNodeMortonIDs.end(); it ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1941</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1942</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          int dest = tree.Morton2Rank( *it );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1943</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          if ( dest &gt;= comm_size ) printf( "%8lu dest %d\n", *it, dest );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1944</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          if ( dest != comm_rank )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1945</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1946</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>            list[ dest ].insert( node-&gt;morton );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1947</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>            //node-&gt;data.FarDependents.insert( dest );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1948</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1949</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          node-&gt;DistFar[ dest ][ *it ] = Data&lt;T&gt;();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1950</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1951</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1952</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1953</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Distributed traversal */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1954</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      #pragma omp for</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1955</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( size_t i = 0; i &lt; tree.mpitreelists.size(); i ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1956</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1957</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        auto *node = tree.mpitreelists[ i ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1958</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        node-&gt;DistFar.resize( comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1959</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        /** Add to the list iff this MPI rank owns the distributed node */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1960</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        if ( tree.Morton2Rank( node-&gt;morton ) == comm_rank )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1961</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1962</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          for ( auto it  = node-&gt;NNFarNodeMortonIDs.begin();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1963</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     it != node-&gt;NNFarNodeMortonIDs.end(); it ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1964</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1965</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>            int dest = tree.Morton2Rank( *it );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1966</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>            if ( dest &gt;= comm_size ) printf( "%8lu dest %d\n", *it, dest );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1967</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>            if ( dest != comm_rank )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1968</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>            {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1969</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>              list[ dest ].insert( node-&gt;morton );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1970</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>              //node-&gt;data.FarDependents.insert( dest );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1971</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>            }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1972</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>            node-&gt;DistFar[ dest ][ *it ]  = Data&lt;T&gt;();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1973</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1974</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1975</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1976</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Merge lists from all threads */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1977</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      #pragma omp critical</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1978</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1979</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        for ( int p = 0; p &lt; comm_size; p ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1980</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          lists[ p ].insert( list[ p ].begin(), list[ p ].end() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1981</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      } /** end pragma omp critical*/</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1982</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1983</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }; /** end pargma omp parallel */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1984</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1985</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Cast set to vector */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1986</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    vector&lt;vector&lt;size_t&gt;&gt; recvlist( comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1987</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( !tree.FarSentToRank.size() ) tree.FarSentToRank.resize( comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1988</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( !tree.FarRecvFromRank.size() ) tree.FarRecvFromRank.resize( comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1989</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    #pragma omp parallel for</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1990</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    for ( int p = 0; p &lt; comm_size; p ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1991</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1992</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      tree.FarSentToRank[ p ].insert( tree.FarSentToRank[ p ].end(),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1993</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          lists[ p ].begin(), lists[ p ].end() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1994</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1995</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1996</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1997</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Use buffer recvlist to catch Alltoallv results. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1998</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpi::AlltoallVector( tree.FarSentToRank, recvlist, tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1999</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2000</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Cast vector of vectors to vector of maps */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2001</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    #pragma omp parallel for</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2002</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    for ( int p = 0; p &lt; comm_size; p ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2003</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( int i = 0; i &lt; recvlist[ p ].size(); i ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2004</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        tree.FarRecvFromRank[ p ][ recvlist[ p ][ i ] ] = i;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2005</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2006</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2007</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  mpi::Barrier( tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2008</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>}; /** end BuildInteractionListPerRank() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2009</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2010</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2011</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename TREE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2012</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>pair&lt;double, double&gt; NonCompressedRatio( TREE &amp;tree )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2013</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2014</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Tree MPI communicator */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2015</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int comm_size; mpi::Comm_size( tree.GetComm(), &amp;comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2016</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int comm_rank; mpi::Comm_rank( tree.GetComm(), &amp;comm_rank );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2017</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2018</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Use double for accumulation. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2019</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  double ratio_n = 0.0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2020</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  double ratio_f = 0.0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2021</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2022</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2023</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Traverse all nodes in the local tree. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2024</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( auto &amp;tar : tree.treelist )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2025</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2026</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( tar-&gt;isleaf )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2027</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2028</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( auto nearID : tar-&gt;NNNearNodeMortonIDs )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2029</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2030</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        auto *src = tree.morton2node[ nearID ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2031</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        assert( src );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2032</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        double m = tar-&gt;gids.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2033</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        double n = src-&gt;gids.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2034</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        double N = tree.n;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2035</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        ratio_n += ( m / N ) * ( n / N );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2036</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2037</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2038</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2039</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    for ( auto farID : tar-&gt;NNFarNodeMortonIDs )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2040</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2041</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto *src = tree.morton2node[ farID ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2042</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      assert( src );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2043</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      double m = tar-&gt;data.skels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2044</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      double n = src-&gt;data.skels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2045</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      double N = tree.n;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2046</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      ratio_f += ( m / N ) * ( n / N );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2047</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2048</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2049</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2050</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Traverse all nodes in the distributed tree. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2051</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( auto &amp;tar : tree.mpitreelists )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2052</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2053</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( !tar-&gt;child || tar-&gt;GetCommRank() ) continue;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2054</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    for ( auto farID : tar-&gt;NNFarNodeMortonIDs )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2055</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2056</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto *src = tree.morton2node[ farID ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2057</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      assert( src );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2058</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      double m = tar-&gt;data.skels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2059</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      double n = src-&gt;data.skels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2060</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      double N = tree.n;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2061</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      ratio_f += ( m / N ) * ( n / N );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2062</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2063</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2064</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2065</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Allreduce total evaluations from all MPI processes. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2066</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  pair&lt;double, double&gt; ret( 0, 0 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2067</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  mpi::Allreduce( &amp;ratio_n, &amp;(ret.first),  1, MPI_SUM, tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2068</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  mpi::Allreduce( &amp;ratio_f, &amp;(ret.second), 1, MPI_SUM, tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2069</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2070</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  return ret;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2071</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>};</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2072</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2073</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2074</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2075</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename T, typename TREE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2076</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void PackNear( TREE &amp;tree, string option, int p,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2077</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    vector&lt;size_t&gt; &amp;sendsizes,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2078</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    vector&lt;size_t&gt; &amp;sendskels,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2079</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    vector&lt;T&gt; &amp;sendbuffs )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2080</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2081</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  vector&lt;size_t&gt; offsets( 1, 0 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2082</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2083</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( auto it : tree.NearSentToRank[ p ] )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2084</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2085</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto *node = tree.morton2node[ it ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2086</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    auto &amp;gids = node-&gt;gids;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2087</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( !option.compare( string( "leafgids" ) ) )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2088</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2089</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      sendsizes.push_back( gids.size() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2090</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      sendskels.insert( sendskels.end(), gids.begin(), gids.end() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2091</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2092</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2093</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2094</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      auto &amp;w_view = node-&gt;data.w_view;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2095</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      sendsizes.push_back( gids.size() * w_view.col() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2096</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      offsets.push_back( sendsizes.back() + offsets.back() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2097</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2098</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2099</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2100</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  if ( offsets.size() ) sendbuffs.resize( offsets.back() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2101</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2102</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  if ( !option.compare( string( "leafweights" ) ) )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2103</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2104</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    #pragma omp parallel for</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2105</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    for ( size_t i = 0; i &lt; tree.NearSentToRank[ p ].size(); i ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2106</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2107</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto *node = tree.morton2node[ tree.NearSentToRank[ p ][ i ] ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2108</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      auto &amp;gids = node-&gt;gids;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2109</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto &amp;w_view = node-&gt;data.w_view;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2110</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto  w_leaf = w_view.toData();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2111</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      size_t offset = offsets[ i ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2112</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( size_t j = 0; j &lt; w_leaf.size(); j ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2113</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        sendbuffs[ offset + j ] = w_leaf[ j ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2114</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2115</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2116</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>};</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2117</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2118</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2119</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename T, typename TREE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2120</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void UnpackLeaf( TREE &amp;tree, string option, int p,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2121</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    const vector&lt;size_t&gt; &amp;recvsizes,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2122</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    const vector&lt;size_t&gt; &amp;recvskels,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2123</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    const vector&lt;T&gt; &amp;recvbuffs )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2124</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2125</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  vector&lt;size_t&gt; offsets( 1, 0 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2126</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( auto it : recvsizes ) offsets.push_back( offsets.back() + it );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2127</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2128</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( auto it : tree.NearRecvFromRank[ p ] )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2129</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2130</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto *node = tree.morton2node[ it.first ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2131</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( !option.compare( string( "leafgids" ) ) )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2132</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2133</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto &amp;gids = node-&gt;gids;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2134</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      size_t i = it.second;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2135</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      gids.reserve( recvsizes[ i ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2136</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( uint64_t j  = offsets[ i + 0 ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2137</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     j  &lt; offsets[ i + 1 ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2138</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                     j ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2139</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2140</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        gids.push_back( recvskels[ j ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2141</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2142</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2143</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2144</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2145</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Number of right hand sides */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2146</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      size_t nrhs = tree.setup.w-&gt;col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2147</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      auto &amp;w_leaf = node-&gt;data.w_leaf;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2148</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      size_t i = it.second;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2149</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      w_leaf.resize( recvsizes[ i ] / nrhs, nrhs );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2150</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //printf( "%d recv w_leaf from %d [%lu %lu]\n",</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2151</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //    comm_rank, p, w_leaf.row(), w_leaf.col() ); fflush( stdout );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2152</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( uint64_t j  = offsets[ i + 0 ], jj = 0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2153</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     j  &lt; offsets[ i + 1 ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2154</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                     j ++,                 jj ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2155</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2156</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        w_leaf[ jj ] = recvbuffs[ j ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2157</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2158</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2159</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2160</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>};</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2161</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2162</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2163</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename T, typename TREE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2164</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void PackFar( TREE &amp;tree, string option, int p,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2165</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    vector&lt;size_t&gt; &amp;sendsizes,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2166</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    vector&lt;size_t&gt; &amp;sendskels,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2167</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    vector&lt;T&gt; &amp;sendbuffs )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2168</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2169</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( auto it : tree.FarSentToRank[ p ] )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2170</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2171</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto *node = tree.morton2node[ it ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2172</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    auto &amp;skels = node-&gt;data.skels;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2173</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( !option.compare( string( "skelgids" ) ) )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2174</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2175</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      sendsizes.push_back( skels.size() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2176</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      sendskels.insert( sendskels.end(), skels.begin(), skels.end() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2177</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2178</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2179</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2180</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      auto &amp;w_skel = node-&gt;data.w_skel;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2181</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      sendsizes.push_back( w_skel.size() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2182</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      sendbuffs.insert( sendbuffs.end(), w_skel.begin(), w_skel.end() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2183</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2184</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2185</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>}; /** end PackFar() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2186</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2187</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2188</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2189</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2190</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2191</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2192</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2193</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2194</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2195</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2196</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2197</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2198</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/** @brief Pack a list of weights and their sizes to two messages. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2199</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename TREE, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2200</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void PackWeights( TREE &amp;tree, int p,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2201</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    vector&lt;T&gt; &amp;sendbuffs, vector&lt;size_t&gt; &amp;sendsizes )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2202</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2203</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( auto it : tree.NearSentToRank[ p ] )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2204</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2205</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto *node = tree.morton2node[ it ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2206</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto w_leaf = node-&gt;data.w_view.toData();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2207</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    sendbuffs.insert( sendbuffs.end(), w_leaf.begin(), w_leaf.end() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2208</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    sendsizes.push_back( w_leaf.size() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2209</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2210</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>}; /** end PackWeights() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2211</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2212</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2213</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/** @brief Unpack a list of weights and their sizes. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2214</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename TREE, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2215</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void UnpackWeights( TREE &amp;tree, int p,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2216</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    const vector&lt;T&gt; recvbuffs, const vector&lt;size_t&gt; &amp;recvsizes )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2217</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2218</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  vector&lt;size_t&gt; offsets( 1, 0 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2219</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( auto it : recvsizes ) offsets.push_back( offsets.back() + it );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2220</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2221</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( auto it : tree.NearRecvFromRank[ p ] )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2222</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2223</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Get LET node pointer. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2224</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto *node = tree.morton2node[ it.first ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2225</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Number of right hand sides */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2226</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    size_t nrhs = tree.setup.w-&gt;col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2227</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    auto &amp;w_leaf = node-&gt;data.w_leaf;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2228</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    size_t i = it.second;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2229</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    w_leaf.resize( recvsizes[ i ] / nrhs, nrhs );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2230</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    for ( uint64_t j  = offsets[ i + 0 ], jj = 0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2231</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   j  &lt; offsets[ i + 1 ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2232</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   j ++,                  jj ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2233</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2234</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      w_leaf[ jj ] = recvbuffs[ j ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2235</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2236</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2237</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>}; /** end UnpackWeights() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2238</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2239</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2240</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2241</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/** @brief Pack a list of skeletons and their sizes to two messages. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2242</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename TREE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2243</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>void PackSkeletons( TREE &amp;tree, int p,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2244</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    vector&lt;size_t&gt; &amp;sendbuffs, vector&lt;size_t&gt; &amp;sendsizes )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2245</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2246</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  for ( auto it : tree.FarSentToRank[ p ] )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2247</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2248</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Get LET node pointer. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2249</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    auto *node = tree.morton2node[ it ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2250</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    auto &amp;skels = node-&gt;data.skels;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2251</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    sendbuffs.insert( sendbuffs.end(), skels.begin(), skels.end() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2252</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    sendsizes.push_back( skels.size() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2253</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2254</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end PackSkeletons() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2255</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2256</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2257</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/** @brief Unpack a list of skeletons and their sizes. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2258</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename TREE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2259</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>void UnpackSkeletons( TREE &amp;tree, int p,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2260</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    const vector&lt;size_t&gt; recvbuffs, const vector&lt;size_t&gt; &amp;recvsizes )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2261</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2262</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  vector&lt;size_t&gt; offsets( 1, 0 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2263</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  for ( auto it : recvsizes ) offsets.push_back( offsets.back() + it );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2264</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2265</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  for ( auto it : tree.FarRecvFromRank[ p ] )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2266</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2267</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Get LET node pointer. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2268</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    auto *node = tree.morton2node[ it.first ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2269</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    auto &amp;skels = node-&gt;data.skels;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2270</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    size_t i = it.second;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2271</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    skels.clear();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2272</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    skels.reserve( recvsizes[ i ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2273</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    for ( uint64_t j  = offsets[ i + 0 ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2274</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   j  &lt; offsets[ i + 1 ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2275</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   j ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2276</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2277</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      skels.push_back( recvbuffs[ j ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2278</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2279</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2280</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end UnpackSkeletons() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2281</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2282</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2283</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2284</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/** @brief Pack a list of skeleton weights and their sizes to two messages. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2285</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename TREE, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2286</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void PackSkeletonWeights( TREE &amp;tree, int p,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2287</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    vector&lt;T&gt; &amp;sendbuffs, vector&lt;size_t&gt; &amp;sendsizes )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2288</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2289</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( auto it : tree.FarSentToRank[ p ] )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2290</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2291</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto *node = tree.morton2node[ it ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2292</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    auto &amp;w_skel = node-&gt;data.w_skel;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2293</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    sendbuffs.insert( sendbuffs.end(), w_skel.begin(), w_skel.end() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2294</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    sendsizes.push_back( w_skel.size() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2295</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2296</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>}; /** end PackSkeletonWeights() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2297</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2298</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2299</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/** @brief Unpack a list of skeletons and their sizes. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2300</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename TREE, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2301</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void UnpackSkeletonWeights( TREE &amp;tree, int p,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2302</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    const vector&lt;T&gt; recvbuffs, const vector&lt;size_t&gt; &amp;recvsizes )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2303</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2304</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  vector&lt;size_t&gt; offsets( 1, 0 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2305</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( auto it : recvsizes ) offsets.push_back( offsets.back() + it );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2306</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2307</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( auto it : tree.FarRecvFromRank[ p ] )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2308</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2309</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Get LET node pointer. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2310</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto *node = tree.morton2node[ it.first ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2311</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Number of right hand sides */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2312</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    size_t nrhs = tree.setup.w-&gt;col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2313</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    auto &amp;w_skel = node-&gt;data.w_skel;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2314</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    size_t i = it.second;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2315</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    w_skel.resize( recvsizes[ i ] / nrhs, nrhs );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2316</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    for ( uint64_t j  = offsets[ i + 0 ], jj = 0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2317</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   j  &lt; offsets[ i + 1 ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2318</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   j ++,                  jj ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2319</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2320</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      w_skel[ jj ] = recvbuffs[ j ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2321</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2322</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2323</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>}; /** end UnpackSkeletonWeights() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2324</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2325</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2326</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2327</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2328</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2329</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2330</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename T, typename TREE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2331</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void UnpackFar( TREE &amp;tree, string option, int p,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2332</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    const vector&lt;size_t&gt; &amp;recvsizes,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2333</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    const vector&lt;size_t&gt; &amp;recvskels,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2334</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    const vector&lt;T&gt; &amp;recvbuffs )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2335</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2336</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  vector&lt;size_t&gt; offsets( 1, 0 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2337</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( auto it : recvsizes ) offsets.push_back( offsets.back() + it );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2338</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2339</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( auto it : tree.FarRecvFromRank[ p ] )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2340</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2341</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Get LET node pointer */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2342</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto *node = tree.morton2node[ it.first ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2343</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( !option.compare( string( "skelgids" ) ) )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2344</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2345</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto &amp;skels = node-&gt;data.skels;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2346</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      size_t i = it.second;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2347</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      skels.clear();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2348</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      skels.reserve( recvsizes[ i ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2349</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( uint64_t j  = offsets[ i + 0 ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2350</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     j  &lt; offsets[ i + 1 ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2351</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                     j ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2352</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2353</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        skels.push_back( recvskels[ j ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2354</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2355</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2356</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2357</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2358</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Number of right hand sides */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2359</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      size_t nrhs = tree.setup.w-&gt;col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2360</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      auto &amp;w_skel = node-&gt;data.w_skel;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2361</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      size_t i = it.second;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2362</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      w_skel.resize( recvsizes[ i ] / nrhs, nrhs );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2363</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //printf( "%d recv w_skel (%8lu) from %d [%lu %lu], i %lu, offset[%lu %lu] \n",</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2364</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //    comm_rank, (*it).first, p, w_skel.row(), w_skel.col(), i,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2365</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //    offsets[ p ][ i + 0 ], offsets[ p ][ i + 1 ] ); fflush( stdout );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2366</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( uint64_t j  = offsets[ i + 0 ], jj = 0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2367</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     j  &lt; offsets[ i + 1 ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2368</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                     j ++,                  jj ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2369</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2370</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        w_skel[ jj ] = recvbuffs[ j ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2371</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        //if ( jj &lt; 5 ) printf( "%E ", w_skel[ jj ] ); fflush( stdout );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2372</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2373</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //printf( "\n" ); fflush( stdout );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2374</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2375</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2376</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>};</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2377</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2378</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2379</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename T, typename TREE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2380</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>class PackNearTask : public SendTask&lt;T, TREE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2381</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2382</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  public:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2383</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2384</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    PackNearTask( TREE *tree, int src, int tar, int key )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2385</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      : SendTask&lt;T, TREE&gt;( tree, src, tar, key )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2386</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2387</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Submit and perform dependency analysis automaticallu. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2388</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      this-&gt;Submit();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2389</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      this-&gt;DependencyAnalysis();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2390</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2391</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2392</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void DependencyAnalysis()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2393</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2394</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      TREE &amp;tree = *(this-&gt;arg);</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2395</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      tree.DependOnNearInteractions( this-&gt;tar, this );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2396</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2397</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2398</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Instansiate Pack() for SendTask. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2399</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Pack()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2400</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2401</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      PackWeights( *this-&gt;arg, this-&gt;tar,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2402</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          this-&gt;send_buffs, this-&gt;send_sizes );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2403</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2404</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2405</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end class PackNearTask */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2406</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2407</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2408</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2409</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2410</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2411</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  AlltoallvTask is used perform MPI_Alltoallv in asynchronous.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2412</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  Overall there will be (p - 1) tasks per MPI rank. Each task</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2413</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  performs Isend while the dependencies toward the destination</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2414</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  is fullfilled.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2415</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2416</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  To receive the results, each MPI rank also actively runs a</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2417</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  ListenerTask. Listener will keep pulling for incioming message</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2418</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  that matches. Once the received results are secured, it will</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2419</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  release dependent tasks.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2420</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2421</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename T, typename TREE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2422</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>class UnpackLeafTask : public RecvTask&lt;T, TREE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2423</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2424</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  public:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2425</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2426</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    UnpackLeafTask( TREE *tree, int src, int tar, int key )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2427</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      : RecvTask&lt;T, TREE&gt;( tree, src, tar, key )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2428</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2429</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Submit and perform dependency analysis automaticallu. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2430</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      this-&gt;Submit();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2431</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      this-&gt;DependencyAnalysis();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2432</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2433</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2434</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Unpack()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2435</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2436</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      UnpackWeights( *this-&gt;arg, this-&gt;src,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2437</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          this-&gt;recv_buffs, this-&gt;recv_sizes );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2438</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2439</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2440</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end class UnpackLeafTask */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2441</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2442</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2443</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/** @brief */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2444</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename T, typename TREE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2445</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>class PackFarTask : public SendTask&lt;T, TREE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2446</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2447</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  public:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2448</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2449</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    PackFarTask( TREE *tree, int src, int tar, int key )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2450</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      : SendTask&lt;T, TREE&gt;( tree, src, tar, key )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2451</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2452</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Submit and perform dependency analysis automaticallu. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2453</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      this-&gt;Submit();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2454</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      this-&gt;DependencyAnalysis();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2455</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2456</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2457</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void DependencyAnalysis()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2458</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2459</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      TREE &amp;tree = *(this-&gt;arg);</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2460</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      tree.DependOnFarInteractions( this-&gt;tar, this );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2461</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2462</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2463</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Instansiate Pack() for SendTask. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2464</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Pack()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2465</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2466</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      PackSkeletonWeights( *this-&gt;arg, this-&gt;tar,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2467</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          this-&gt;send_buffs, this-&gt;send_sizes );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2468</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2469</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2470</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end class PackFarTask */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2471</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2472</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2473</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/** @brief */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2474</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename T, typename TREE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2475</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>class UnpackFarTask : public RecvTask&lt;T, TREE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2476</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2477</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  public:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2478</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2479</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    UnpackFarTask( TREE *tree, int src, int tar, int key )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2480</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      : RecvTask&lt;T, TREE&gt;( tree, src, tar, key )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2481</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2482</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Submit and perform dependency analysis automaticallu. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2483</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      this-&gt;Submit();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2484</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      this-&gt;DependencyAnalysis();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2485</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2486</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2487</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Unpack()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2488</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2489</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      UnpackSkeletonWeights( *this-&gt;arg, this-&gt;src,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2490</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          this-&gt;recv_buffs, this-&gt;recv_sizes );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2491</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2492</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2493</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end class UnpackFarTask */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2494</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2495</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2496</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2497</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2498</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2499</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2500</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2501</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2502</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2503</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2504</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2505</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2506</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  Send my skeletons (in gids and params) to other ranks</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2507</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  using FarSentToRank[:].</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2508</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2509</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  Recv skeletons from other ranks</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2510</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  using FarRecvFromRank[:].</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2511</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2512</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename TREE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2513</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void ExchangeLET( TREE &amp;tree, string option )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2514</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2515</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Derive type T from TREE. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2516</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  using T = typename TREE::T;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2517</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** MPI Support. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2518</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int comm_size; mpi::Comm_size( tree.GetComm(), &amp;comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2519</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int comm_rank; mpi::Comm_rank( tree.GetComm(), &amp;comm_rank );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2520</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2521</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Buffers for sizes and skeletons */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2522</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  vector&lt;vector&lt;size_t&gt;&gt; sendsizes( comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2523</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  vector&lt;vector&lt;size_t&gt;&gt; recvsizes( comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2524</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  vector&lt;vector&lt;size_t&gt;&gt; sendskels( comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2525</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  vector&lt;vector&lt;size_t&gt;&gt; recvskels( comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2526</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  vector&lt;vector&lt;T&gt;&gt;      sendbuffs( comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2527</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  vector&lt;vector&lt;T&gt;&gt;      recvbuffs( comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2528</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2529</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Pack */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2530</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  #pragma omp parallel for</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2531</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( int p = 0; p &lt; comm_size; p ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2532</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2533</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( !option.compare( 0, 4, "leaf" ) )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2534</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2535</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      PackNear( tree, option, p, sendsizes[ p ], sendskels[ p ], sendbuffs[ p ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2536</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2537</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    else if ( !option.compare( 0, 4, "skel" ) )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2538</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2539</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      PackFar( tree, option, p, sendsizes[ p ], sendskels[ p ], sendbuffs[ p ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2540</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2541</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2542</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2543</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "ExchangeLET: option &lt;%s&gt; not available.\n", option.data() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2544</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      exit( 1 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2545</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2546</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2547</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2548</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Alltoallv */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2549</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  mpi::AlltoallVector( sendsizes, recvsizes, tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2550</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  if ( !option.compare( string( "skelgids" ) ) ||</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2551</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       !option.compare( string( "leafgids" ) ) )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2552</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2553</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto &amp;K = *tree.setup.K;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2554</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpi::AlltoallVector( sendskels, recvskels, tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2555</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    K.RequestIndices( recvskels );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2556</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2557</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2558</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2559</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    double beg = omp_get_wtime();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2560</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpi::AlltoallVector( sendbuffs, recvbuffs, tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2561</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    double a2av_time = omp_get_wtime() - beg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2562</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( comm_rank == 0 ) printf( "a2av_time %lfs\n", a2av_time );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2563</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2564</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2565</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2566</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Uppack */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2567</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  #pragma omp parallel for</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2568</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( int p = 0; p &lt; comm_size; p ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2569</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2570</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( !option.compare( 0, 4, "leaf" ) )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2571</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2572</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      UnpackLeaf( tree, option, p, recvsizes[ p ], recvskels[ p ], recvbuffs[ p ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2573</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2574</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    else if ( !option.compare( 0, 4, "skel" ) )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2575</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2576</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      UnpackFar( tree, option, p, recvsizes[ p ], recvskels[ p ], recvbuffs[ p ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2577</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2578</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2579</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2580</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "ExchangeLET: option &lt;%s&gt; not available.\n", option.data() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2581</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      exit( 1 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2582</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2583</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2584</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2585</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2586</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>}; /** end ExchangeLET() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2587</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2588</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2589</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2590</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename T, typename TREE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2591</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void AsyncExchangeLET( TREE &amp;tree, string option )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2592</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2593</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** MPI */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2594</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int comm_size; mpi::Comm_size( tree.GetComm(), &amp;comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2595</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int comm_rank; mpi::Comm_rank( tree.GetComm(), &amp;comm_rank );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2596</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2597</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Create sending tasks. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2598</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( int p = 0; p &lt; comm_size; p ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2599</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2600</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( !option.compare( 0, 4, "leaf" ) )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2601</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2602</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto *task = new PackNearTask&lt;T, TREE&gt;( &amp;tree, comm_rank, p, 300 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2603</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Set src, tar, and key (tags). */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2604</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //task-&gt;Set( &amp;tree, comm_rank, p, 300 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2605</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //task-&gt;Submit();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2606</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //task-&gt;DependencyAnalysis();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2607</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2608</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    else if ( !option.compare( 0, 4, "skel" ) )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2609</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2610</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto *task = new PackFarTask&lt;T, TREE&gt;( &amp;tree, comm_rank, p, 306 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2611</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Set src, tar, and key (tags). */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2612</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //task-&gt;Set( &amp;tree, comm_rank, p, 306 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2613</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //task-&gt;Submit();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2614</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //task-&gt;DependencyAnalysis();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2615</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2616</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2617</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2618</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "AsyncExchangeLET: option &lt;%s&gt; not available.\n", option.data() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2619</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      exit( 1 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2620</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2621</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2622</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2623</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Create receiving tasks */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2624</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( int p = 0; p &lt; comm_size; p ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2625</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2626</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( !option.compare( 0, 4, "leaf" ) )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2627</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2628</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto *task = new UnpackLeafTask&lt;T, TREE&gt;( &amp;tree, p, comm_rank, 300 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2629</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Set src, tar, and key (tags). */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2630</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //task-&gt;Set( &amp;tree, p, comm_rank, 300 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2631</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //task-&gt;Submit();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2632</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //task-&gt;DependencyAnalysis();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2633</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2634</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    else if ( !option.compare( 0, 4, "skel" ) )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2635</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2636</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto *task = new UnpackFarTask&lt;T, TREE&gt;( &amp;tree, p, comm_rank, 306 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2637</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Set src, tar, and key (tags). */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2638</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //task-&gt;Set( &amp;tree, p, comm_rank, 306 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2639</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //task-&gt;Submit();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2640</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //task-&gt;DependencyAnalysis();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2641</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2642</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2643</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2644</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "AsyncExchangeLET: option &lt;%s&gt; not available.\n", option.data() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2645</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      exit( 1 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2646</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2647</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2648</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2649</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>}; /** AsyncExchangeLET() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2650</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2651</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2652</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2653</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2654</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename T, typename TREE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2655</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void ExchangeNeighbors( TREE &amp;tree )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2656</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2657</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  mpi::PrintProgress( "[BEG] ExchangeNeighbors ...", tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2658</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2659</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int comm_rank; mpi::Comm_rank( tree.GetComm(), &amp;comm_rank );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2660</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int comm_size; mpi::Comm_size( tree.GetComm(), &amp;comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2661</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2662</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Alltoallv buffers */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2663</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  vector&lt;vector&lt;size_t&gt;&gt; send_buff( comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2664</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  vector&lt;vector&lt;size_t&gt;&gt; recv_buff( comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2665</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2666</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** NN&lt;STAR, CIDS, pair&lt;T, size_t&gt;&gt; */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2667</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  unordered_set&lt;size_t&gt; requested_gids;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2668</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto &amp;NN = *tree.setup.NN;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2669</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2670</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Remove duplication. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2671</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( auto &amp; it : NN )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2672</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2673</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( it.second &gt;= 0 &amp;&amp; it.second &lt; tree.n )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2674</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      requested_gids.insert( it.second );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2675</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2676</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2677</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Remove owned gids. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2678</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( auto it : tree.treelist[ 0 ]-&gt;gids ) requested_gids.erase( it );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2679</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2680</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Assume gid is owned by (gid % size) */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2681</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( auto it :requested_gids )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2682</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2683</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    int p = it % comm_size;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2684</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( p != comm_rank ) send_buff[ p ].push_back( it );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2685</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2686</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2687</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Redistribute K. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2688</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto &amp;K = *tree.setup.K;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2689</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  K.RequestIndices( send_buff );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2690</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2691</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  mpi::PrintProgress( "[END] ExchangeNeighbors ...", tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2692</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>}; /** end ExchangeNeighbors() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2693</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2694</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2695</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2696</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2697</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2698</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2699</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2700</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2701</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2702</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2703</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2704</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;bool SYMMETRIC, typename NODE, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2705</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void MergeFarNodes( NODE *node )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2706</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2707</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** if I don't have any skeleton, then I'm nobody's far field */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2708</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //if ( !node-&gt;data.isskel ) return;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2709</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2710</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2711</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>   *  Examine "Near" interaction list</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2712</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>   */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2713</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //if ( node-&gt;isleaf )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2714</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2715</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //   auto &amp; NearMortonIDs = node-&gt;NNNearNodeMortonIDs;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2716</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //   #pragma omp critical</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2717</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //   {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2718</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //     int rank;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2719</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //     mpi::Comm_rank( MPI_COMM_WORLD, &amp;rank );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2720</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //     string outfile = to_string( rank );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2721</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //     FILE * pFile = fopen( outfile.data(), "a+" );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2722</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //     fprintf( pFile, "(%8lu) ", node-&gt;morton );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2723</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //     for ( auto it = NearMortonIDs.begin(); it != NearMortonIDs.end(); it ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2724</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //       fprintf( pFile, "%8lu, ", (*it) );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2725</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //     fprintf( pFile, "\n" ); //fflush( stdout );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2726</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //   }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2727</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2728</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //   //auto &amp; NearNodes = node-&gt;NNNearNodes;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2729</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //   //for ( auto it = NearNodes.begin(); it != NearNodes.end(); it ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2730</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //   //{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2731</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //   //  if ( !(*it)-&gt;NNNearNodes.count( node ) )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2732</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //   //  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2733</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //   //    printf( "(%8lu) misses %lu\n", (*it)-&gt;morton, node-&gt;morton ); fflush( stdout );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2734</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //   //  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2735</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //   //}</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2736</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //};</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2737</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2738</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2739</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Add my sibling (in the same level) to far interaction lists */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2740</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  assert( !node-&gt;FarNodeMortonIDs.size() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2741</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  assert( !node-&gt;FarNodes.size() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2742</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  node-&gt;FarNodeMortonIDs.insert( node-&gt;sibling-&gt;morton );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2743</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  node-&gt;FarNodes.insert( node-&gt;sibling );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2744</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2745</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Construct NN far interaction lists */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2746</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  if ( node-&gt;isleaf )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2747</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2748</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    FindFarNodes( MortonHelper::Root(), node );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2749</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2750</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2751</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2752</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Merge Far( lchild ) and Far( rchild ) from children */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2753</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto *lchild = node-&gt;lchild;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2754</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto *rchild = node-&gt;rchild;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2755</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2756</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** case: NNPRUNE (FMM specific) */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2757</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    auto &amp;pNNFarNodes =   node-&gt;NNFarNodeMortonIDs;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2758</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    auto &amp;lNNFarNodes = lchild-&gt;NNFarNodeMortonIDs;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2759</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    auto &amp;rNNFarNodes = rchild-&gt;NNFarNodeMortonIDs;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2760</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2761</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Far( parent ) = Far( lchild ) intersects Far( rchild ) */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2762</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    for ( auto it  = lNNFarNodes.begin();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2763</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               it != lNNFarNodes.end(); it ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2764</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2765</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      if ( rNNFarNodes.count( *it ) )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2766</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2767</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        pNNFarNodes.insert( *it );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2768</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2769</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2770</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Far( lchild ) \= Far( parent ); Far( rchild ) \= Far( parent ) */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2771</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    for ( auto it  = pNNFarNodes.begin();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2772</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               it != pNNFarNodes.end(); it ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2773</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2774</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      lNNFarNodes.erase( *it );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2775</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      rNNFarNodes.erase( *it );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2776</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2777</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2778</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2779</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>}; /** end MergeFarNodes() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2780</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2781</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2782</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2783</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;bool SYMMETRIC, typename NODE, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2784</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>class MergeFarNodesTask : public Task</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2785</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2786</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  public:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2787</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2788</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    NODE *arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2789</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2790</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Set( NODE *user_arg )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2791</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2792</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      arg = user_arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2793</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      name = string( "merge" );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2794</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      label = to_string( arg-&gt;treelist_id );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2795</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** we don't know the exact cost here */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2796</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      cost = 5.0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2797</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** high priority */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2798</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      priority = true;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2799</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2800</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2801</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>		/** read this node and write to children */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2802</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void DependencyAnalysis()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2803</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2804</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      arg-&gt;DependencyAnalysis( RW, this );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2805</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      if ( !arg-&gt;isleaf )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2806</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2807</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        arg-&gt;lchild-&gt;DependencyAnalysis( RW, this );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2808</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        arg-&gt;rchild-&gt;DependencyAnalysis( RW, this );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2809</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2810</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      this-&gt;TryEnqueue();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2811</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2812</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2813</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Execute( Worker* user_worker )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2814</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2815</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      MergeFarNodes&lt;SYMMETRIC, NODE, T&gt;( arg );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2816</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2817</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2818</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end class MergeFarNodesTask */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2819</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2820</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2821</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2822</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2823</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2824</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2825</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2826</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2827</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2828</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2829</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2830</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2831</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;bool SYMMETRIC, typename NODE, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2832</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void DistMergeFarNodes( NODE *node )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2833</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2834</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** MPI */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2835</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  mpi::Status status;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2836</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  mpi::Comm comm = node-&gt;GetComm();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2837</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  int comm_size = node-&gt;GetCommSize();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2838</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  int comm_rank = node-&gt;GetCommRank();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2839</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2840</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** if I don't have any skeleton, then I'm nobody's far field */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2841</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //if ( !node-&gt;data.isskel ) return;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2842</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2843</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2844</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Early return if this is the root node. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2845</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  if ( !node-&gt;parent ) return;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2846</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2847</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Distributed treenode */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2848</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  if ( node-&gt;GetCommSize() &lt; 2 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2849</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2850</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    MergeFarNodes&lt;SYMMETRIC, NODE, T&gt;( node );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2851</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2852</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2853</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2854</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** merge Far( lchild ) and Far( rchild ) from children */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2855</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto *child = node-&gt;child;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2856</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2857</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( comm_rank == 0 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2858</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2859</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      auto &amp;pNNFarNodes =  node-&gt;NNFarNodeMortonIDs;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2860</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      auto &amp;lNNFarNodes = child-&gt;NNFarNodeMortonIDs;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2861</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      vector&lt;size_t&gt; recvFarNodes;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2862</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2863</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Recv rNNFarNodes */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2864</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      mpi::RecvVector( recvFarNodes, comm_size / 2, 0, comm, &amp;status );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2865</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2866</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Far( parent ) = Far( lchild ) intersects Far( rchild ). */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2867</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( auto it : recvFarNodes )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2868</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2869</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        if ( lNNFarNodes.count( it ) )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2870</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2871</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          pNNFarNodes.insert( it );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2872</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2873</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2874</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2875</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Reuse space to send pNNFarNodes. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2876</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      recvFarNodes.clear();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2877</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      recvFarNodes.reserve( pNNFarNodes.size() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2878</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2879</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Far( lchild ) \= Far( parent ); Far( rchild ) \= Far( parent ). */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2880</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( auto it : pNNFarNodes )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2881</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2882</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        lNNFarNodes.erase( it );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2883</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        recvFarNodes.push_back( it );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2884</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2885</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2886</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Send pNNFarNodes. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2887</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      mpi::SendVector( recvFarNodes, comm_size / 2, 0, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2888</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2889</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2890</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2891</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( comm_rank == comm_size / 2 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2892</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2893</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      auto &amp;rNNFarNodes = child-&gt;NNFarNodeMortonIDs;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2894</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      vector&lt;size_t&gt; sendFarNodes( rNNFarNodes.begin(), rNNFarNodes.end() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2895</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2896</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Send rNNFarNodes. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2897</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      mpi::SendVector( sendFarNodes, 0, 0, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2898</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Recuse sendFarNodes to receive pNNFarNodes. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2899</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      mpi::RecvVector( sendFarNodes, 0, 0, comm, &amp;status );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2900</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Far( lchild ) \= Far( parent ); Far( rchild ) \= Far( parent ) */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2901</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( auto it : sendFarNodes ) rNNFarNodes.erase( it );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2902</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2903</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2904</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2905</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end DistMergeFarNodes() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2906</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2907</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2908</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2909</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;bool SYMMETRIC, typename NODE, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2910</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>class DistMergeFarNodesTask : public Task</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2911</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2912</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  public:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2913</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2914</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    NODE *arg = NULL;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2915</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2916</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Set( NODE *user_arg )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2917</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2918</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      arg = user_arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2919</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      name = string( "dist-merge" );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2920</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      label = to_string( arg-&gt;treelist_id );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2921</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** we don't know the exact cost here */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2922</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      cost = 5.0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2923</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** high priority */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2924</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      priority = true;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2925</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2926</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2927</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>		/** read this node and write to children */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2928</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void DependencyAnalysis()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2929</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2930</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      arg-&gt;DependencyAnalysis( RW, this );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2931</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      if ( !arg-&gt;isleaf )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2932</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2933</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        if ( arg-&gt;GetCommSize() &gt; 1 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2934</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2935</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          arg-&gt;child-&gt;DependencyAnalysis( RW, this );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2936</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2937</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2938</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2939</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          arg-&gt;lchild-&gt;DependencyAnalysis( RW, this );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2940</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          arg-&gt;rchild-&gt;DependencyAnalysis( RW, this );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2941</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2942</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2943</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      this-&gt;TryEnqueue();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2944</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2945</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2946</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Execute( Worker* user_worker )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2947</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2948</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      DistMergeFarNodes&lt;SYMMETRIC, NODE, T&gt;( arg );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2949</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2950</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2951</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end class DistMergeFarNodesTask */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2952</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2953</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2954</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2955</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2956</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2957</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2958</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2959</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2960</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2961</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;bool NNPRUNE, typename NODE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2962</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>class CacheFarNodesTask : public Task</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2963</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2964</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  public:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2965</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2966</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    NODE *arg = NULL;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2967</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2968</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    void Set( NODE *user_arg )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2969</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2970</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      arg = user_arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2971</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      name = string( "FKIJ" );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2972</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      label = to_string( arg-&gt;treelist_id );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2973</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Compute FLOPS and MOPS. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2974</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      double flops = 0, mops = 0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2975</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** We don't know the exact cost here. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2976</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      cost = 5.0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2977</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2978</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2979</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void DependencyAnalysis()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2980</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2981</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      arg-&gt;DependencyAnalysis( RW, this );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2982</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      this-&gt;TryEnqueue();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2983</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2984</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2985</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Execute( Worker* user_worker )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2986</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2987</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto *node = arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2988</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto &amp;K = *node-&gt;setup-&gt;K;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2989</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2990</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( int p = 0; p &lt; node-&gt;DistFar.size(); p ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2991</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2992</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        for ( auto &amp;it : node-&gt;DistFar[ p ] )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2993</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2994</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          auto *src = (*node-&gt;morton2node)[ it.first ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2995</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          auto &amp;I = node-&gt;data.skels;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2996</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          auto &amp;J = src-&gt;data.skels;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2997</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          it.second = K( I, J );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2998</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          //printf( "Cache I %lu J %lu\n", I.size(), J.size() ); fflush( stdout );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2999</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3000</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3001</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3002</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3003</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end class CacheFarNodesTask */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3004</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3005</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3006</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3007</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3008</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3009</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3010</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3011</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3012</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3013</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;bool NNPRUNE, typename NODE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3014</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>class CacheNearNodesTask : public Task</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3015</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3016</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  public:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3017</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3018</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    NODE *arg = NULL;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3019</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3020</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    void Set( NODE *user_arg )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3021</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3022</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      arg = user_arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3023</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      name = string( "NKIJ" );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3024</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      label = to_string( arg-&gt;treelist_id );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3025</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** We don't know the exact cost here */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3026</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      cost = 5.0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3027</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3028</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3029</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void DependencyAnalysis()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3030</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3031</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      arg-&gt;DependencyAnalysis( RW, this );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3032</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      this-&gt;TryEnqueue();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3033</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3034</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3035</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Execute( Worker* user_worker )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3036</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3037</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto *node = arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3038</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto &amp;K = *node-&gt;setup-&gt;K;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3039</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3040</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( int p = 0; p &lt; node-&gt;DistNear.size(); p ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3041</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3042</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        for ( auto &amp;it : node-&gt;DistNear[ p ] )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3043</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3044</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          auto *src = (*node-&gt;morton2node)[ it.first ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3045</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          auto &amp;I = node-&gt;gids;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3046</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          auto &amp;J = src-&gt;gids;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3047</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          it.second = K( I, J );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3048</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          //printf( "Cache I %lu J %lu\n", I.size(), J.size() ); fflush( stdout );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3049</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3050</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3051</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3052</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3053</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end class CacheNearNodesTask */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3054</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3055</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3056</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3057</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3058</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3059</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3060</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3061</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3062</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3063</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3064</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3065</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3066</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename NODE, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3067</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void DistRowSamples( NODE *node, size_t nsamples )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3068</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3069</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** MPI */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3070</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  mpi::Comm comm = node-&gt;GetComm();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3071</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  int size = node-&gt;GetCommSize();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3072</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  int rank = node-&gt;GetCommRank();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3073</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3074</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** gather shared data and create reference */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3075</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto &amp;K = *node-&gt;setup-&gt;K;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3076</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3077</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** amap contains nsamples of row gids of K */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3078</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  vector&lt;size_t&gt; &amp;I = node-&gt;data.candidate_rows;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3079</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3080</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Clean up candidates from previous iteration */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3081</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>	I.clear();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3082</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3083</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Fill-on snids first */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3084</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>	if ( rank == 0 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3085</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3086</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** reserve space */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3087</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    I.reserve( nsamples );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3088</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3089</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto &amp;snids = node-&gt;data.snids;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3090</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    multimap&lt;T, size_t&gt; ordered_snids = gofmm::flip_map( snids );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3091</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3092</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    for ( auto it  = ordered_snids.begin();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3093</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               it != ordered_snids.end(); it++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3094</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3095</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** (*it) has type pair&lt;T, size_t&gt; */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3096</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      I.push_back( (*it).second );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3097</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      if ( I.size() &gt;= nsamples ) break;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3098</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3099</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3100</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3101</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>	/** buffer space */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3102</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>	vector&lt;size_t&gt; candidates( nsamples );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3103</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3104</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>	size_t n_required = nsamples - I.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3105</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3106</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>	/** bcast the termination criteria */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3107</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>	mpi::Bcast( &amp;n_required, 1, 0, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3108</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3109</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>	while ( n_required )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3110</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>	{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3111</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>		if ( rank == 0 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3112</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>		{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3113</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  	  for ( size_t i = 0; i &lt; nsamples; i ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3114</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3115</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        auto important_sample = K.ImportantSample( 0 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3116</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        candidates[ i ] =  important_sample.second;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3117</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3118</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>		}</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3119</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3120</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>		/** Bcast candidates */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3121</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>		mpi::Bcast( candidates.data(), candidates.size(), 0, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3122</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3123</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>		/** validation */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3124</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>		vector&lt;size_t&gt; vconsensus( nsamples, 0 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3125</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>	  vector&lt;size_t&gt; validation = node-&gt;setup-&gt;ContainAny( candidates, node-&gt;morton );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3126</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3127</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>		/** reduce validation */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3128</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>		mpi::Reduce( validation.data(), vconsensus.data(), nsamples, MPI_SUM, 0, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3129</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3130</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>	  if ( rank == 0 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3131</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>		{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3132</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  	  for ( size_t i = 0; i &lt; nsamples; i ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3133</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>			{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3134</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>				/** exit is there is enough samples */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3135</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>				if ( I.size() &gt;= nsamples )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3136</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>				{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3137</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>					I.resize( nsamples );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3138</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>					break;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3139</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>				}</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3140</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>				/** Push the candidate to I after validation */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3141</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>				if ( !vconsensus[ i ] )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3142</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>				{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3143</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>					if ( find( I.begin(), I.end(), candidates[ i ] ) == I.end() )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3144</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>						I.push_back( candidates[ i ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3145</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>				}</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3146</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>			};</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3147</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3148</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>			/** Update n_required */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3149</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>	    n_required = nsamples - I.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3150</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>		}</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3151</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3152</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>	  /** Bcast the termination criteria */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3153</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>	  mpi::Bcast( &amp;n_required, 1, 0, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3154</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>	}</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3155</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3156</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>}; /** end DistRowSamples() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3157</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3158</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3159</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3160</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3161</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3162</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3163</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/** @brief Involve MPI routins */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3164</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;bool NNPRUNE, typename NODE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3165</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void DistSkeletonKIJ( NODE *node )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3166</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3167</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Derive type T from NODE. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3168</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  using T = typename NODE::T;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3169</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>	/** Early return */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3170</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>	if ( !node-&gt;parent ) return;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3171</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Gather shared data and create reference. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3172</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto &amp;K = *(node-&gt;setup-&gt;K);</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3173</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Gather per node data and create reference. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3174</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  auto &amp;data = node-&gt;data;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3175</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto &amp;candidate_rows = data.candidate_rows;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3176</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto &amp;candidate_cols = data.candidate_cols;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3177</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto &amp;KIJ = data.KIJ;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3178</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3179</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** MPI Support. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3180</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  auto comm = node-&gt;GetComm();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3181</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  auto size = node-&gt;GetCommSize();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3182</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  auto rank = node-&gt;GetCommRank();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3183</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  mpi::Status status;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3184</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3185</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  if ( size &lt; 2 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3186</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3187</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** This node is the root of the local tree. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3188</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    gofmm::SkeletonKIJ&lt;NNPRUNE&gt;( node );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3189</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3190</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3191</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3192</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** This node (mpitree::Node) belongs to the distributed tree</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3193</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     *  only executed by 0th and size/2 th rank of</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3194</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     *  the node communicator. At this moment, children have been</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3195</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     *  skeletonized. Thus, we should first update (isskel) to</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3196</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     *  all MPI processes. Then we gather information for the</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3197</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     *  skeletonization.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3198</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3199</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    NODE *child = node-&gt;child;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3200</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>		size_t nsamples = 0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3201</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3202</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Bcast (isskel) to all MPI processes using children's communicator. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3203</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    int child_isskel = child-&gt;data.isskel;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3204</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    mpi::Bcast( &amp;child_isskel, 1, 0, child-&gt;GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3205</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    child-&gt;data.isskel = child_isskel;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3206</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3207</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3208</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** rank-0 owns data of this node, and it also owns the left child. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3209</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( rank == 0 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3210</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3211</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      candidate_cols = child-&gt;data.skels;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3212</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      vector&lt;size_t&gt; rskel;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3213</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Receive rskel from my sibling. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3214</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      mpi::RecvVector( rskel, size / 2, 10, comm, &amp;status );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3215</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Correspondingly, we need to redistribute the matrix K. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3216</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      K.RecvIndices( size / 2, comm, &amp;status );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3217</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Concatinate [ lskels, rskels ]. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3218</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      candidate_cols.insert( candidate_cols.end(), rskel.begin(), rskel.end() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3219</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>			/** Use two times of skeletons */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3220</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      nsamples = 2 * candidate_cols.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3221</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Make sure we at least m samples */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3222</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      if ( nsamples &lt; 2 * node-&gt;setup-&gt;LeafNodeSize() )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3223</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        nsamples = 2 * node-&gt;setup-&gt;LeafNodeSize();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3224</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3225</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Gather rsnids. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3226</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto &amp;lsnids = node-&gt;child-&gt;data.snids;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3227</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      vector&lt;T&gt;      recv_rsdist;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3228</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      vector&lt;size_t&gt; recv_rsnids;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3229</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3230</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Receive rsnids from size / 2. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3231</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      mpi::RecvVector( recv_rsdist, size / 2, 20, comm, &amp;status );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3232</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      mpi::RecvVector( recv_rsnids, size / 2, 30, comm, &amp;status );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3233</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Correspondingly, we need to redistribute the matrix K. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3234</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      K.RecvIndices( size / 2, comm, &amp;status );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3235</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3236</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3237</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Merge snids and update the smallest distance. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3238</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      auto &amp;snids = node-&gt;data.snids;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3239</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      snids = lsnids;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3240</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3241</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( size_t i = 0; i &lt; recv_rsdist.size(); i ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3242</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3243</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        pair&lt;size_t, T&gt; query( recv_rsnids[ i ], recv_rsdist[ i ] );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3244</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        auto ret = snids.insert( query );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3245</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        if ( !ret.second )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3246</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3247</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          if ( ret.first-&gt;second &gt; recv_rsdist[ i ] )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3248</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>            ret.first-&gt;second = recv_rsdist[ i ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3249</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3250</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3251</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3252</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Remove gids from snids */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3253</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( auto gid : node-&gt;gids ) snids.erase( gid );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3254</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3255</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3256</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( rank == size / 2 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3257</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3258</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Send rskel to rank 0. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3259</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      mpi::SendVector( child-&gt;data.skels, 0, 10, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3260</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Correspondingly, we need to redistribute the matrix K. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3261</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      K.SendIndices( child-&gt;data.skels, 0, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3262</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3263</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Gather rsnids */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3264</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto &amp;rsnids = node-&gt;child-&gt;data.snids;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3265</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      vector&lt;T&gt;      send_rsdist;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3266</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      vector&lt;size_t&gt; send_rsnids;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3267</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3268</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** reserve space and push in from map */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3269</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      send_rsdist.reserve( rsnids.size() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3270</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      send_rsnids.reserve( rsnids.size() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3271</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3272</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( auto it = rsnids.begin(); it != rsnids.end(); it ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3273</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3274</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        /** (*it) has type std::pair&lt;size_t, T&gt;  */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3275</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        send_rsnids.push_back( (*it).first  );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3276</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        send_rsdist.push_back( (*it).second );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3277</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3278</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3279</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** send rsnids to rank-0 */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3280</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      mpi::SendVector( send_rsdist, 0, 20, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3281</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      mpi::SendVector( send_rsnids, 0, 30, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3282</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3283</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Correspondingly, we need to redistribute the matrix K. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3284</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      K.SendIndices( send_rsnids, 0, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3285</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3286</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3287</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>		/** Bcast nsamples. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3288</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>		mpi::Bcast( &amp;nsamples, 1, 0, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3289</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>		/** Distributed row samples. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3290</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>		DistRowSamples&lt;NODE, T&gt;( node, nsamples );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3291</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** only rank-0 has non-empty I and J sets */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3292</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( rank != 0 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3293</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3294</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      assert( !candidate_rows.size() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3295</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      assert( !candidate_cols.size() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3296</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3297</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3298</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     *  Now rank-0 has the correct ( I, J ). All other ranks in the</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3299</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     *  communicator must flush their I and J sets before evaluation.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3300</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     *  all MPI process must participate in operator ()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3301</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3302</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    KIJ = K( candidate_rows, candidate_cols );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3303</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3304</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end DistSkeletonKIJ() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3305</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3306</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3307</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3308</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3309</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3310</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;bool NNPRUNE, typename NODE, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3311</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>class DistSkeletonKIJTask : public Task</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3312</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3313</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  public:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3314</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3315</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    NODE *arg = NULL;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3316</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3317</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Set( NODE *user_arg )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3318</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3319</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      arg = user_arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3320</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      name = string( "par-gskm" );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3321</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      label = to_string( arg-&gt;treelist_id );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3322</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** We don't know the exact cost here */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3323</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      cost = 5.0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3324</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** "High" priority */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3325</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      priority = true;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3326</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3327</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3328</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void DependencyAnalysis() { arg-&gt;DependOnChildren( this ); };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3329</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3330</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Execute( Worker* user_worker ) { DistSkeletonKIJ&lt;NNPRUNE&gt;( arg ); };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3331</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3332</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end class DistSkeletonKIJTask */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3333</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3334</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3335</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3336</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3337</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3338</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3339</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3340</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3341</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3342</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3343</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3344</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3345</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3346</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  @brief Skeletonization with interpolative decomposition.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3347</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3348</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename NODE, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3349</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void DistSkeletonize( NODE *node )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3350</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3351</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** early return if we do not need to skeletonize */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3352</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  if ( !node-&gt;parent ) return;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3353</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3354</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** gather shared data and create reference */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3355</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto &amp;K   = *(node-&gt;setup-&gt;K);</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3356</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  auto &amp;NN  = *(node-&gt;setup-&gt;NN);</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3357</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  auto maxs = node-&gt;setup-&gt;MaximumRank();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3358</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  auto stol = node-&gt;setup-&gt;Tolerance();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3359</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  bool secure_accuracy = node-&gt;setup-&gt;SecureAccuracy();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3360</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  bool use_adaptive_ranks = node-&gt;setup-&gt;UseAdaptiveRanks();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3361</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3362</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** gather per node data and create reference */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3363</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  auto &amp;data  = node-&gt;data;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3364</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto &amp;skels = data.skels;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3365</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto &amp;proj  = data.proj;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3366</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto &amp;jpvt  = data.jpvt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3367</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto &amp;KIJ   = data.KIJ;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3368</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  auto &amp;candidate_cols = data.candidate_cols;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3369</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3370</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** interpolative decomposition */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3371</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  size_t N = K.col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3372</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  size_t m = KIJ.row();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3373</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  size_t n = KIJ.col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3374</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  size_t q = node-&gt;n;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3375</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3376</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  if ( secure_accuracy )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3377</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3378</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** TODO: need to check of both children's isskel to preceed */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3379</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3380</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3381</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3382</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Bill's l2 norm scaling factor */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3383</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  T scaled_stol = std::sqrt( (T)n / q ) * std::sqrt( (T)m / (N - q) ) * stol;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3384</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3385</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** account for uniform sampling */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3386</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  scaled_stol *= std::sqrt( (T)q / N );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3387</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3388</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  lowrank::id</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3389</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  (</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3390</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    use_adaptive_ranks, secure_accuracy,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3391</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    KIJ.row(), KIJ.col(), maxs, scaled_stol,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3392</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    KIJ, skels, proj, jpvt</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3393</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3394</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3395</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Free KIJ for spaces */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3396</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  KIJ.resize( 0, 0 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3397</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  KIJ.shrink_to_fit();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3398</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3399</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** depending on the flag, decide isskel or not */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3400</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  if ( secure_accuracy )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3401</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3402</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** TODO: this needs to be bcast to other nodes */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3403</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    data.isskel = (skels.size() != 0);</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3404</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3405</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3406</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3407</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    assert( skels.size() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3408</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    assert( proj.size() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3409</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    assert( jpvt.size() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3410</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    data.isskel = true;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3411</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3412</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3413</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Relabel skeletions with the real gids */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3414</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( size_t i = 0; i &lt; skels.size(); i ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3415</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3416</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    skels[ i ] = candidate_cols[ skels[ i ] ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3417</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3418</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3419</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3420</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end DistSkeletonize() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3421</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3422</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3423</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3424</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3425</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename NODE, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3426</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>class SkeletonizeTask : public hmlp::Task</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3427</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3428</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  public:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3429</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3430</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    NODE *arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3431</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3432</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Set( NODE *user_arg )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3433</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3434</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      arg = user_arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3435</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      name = string( "SK" );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3436</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      label = to_string( arg-&gt;treelist_id );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3437</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** We don't know the exact cost here */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3438</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      cost = 5.0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3439</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** "High" priority */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3440</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      priority = true;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3441</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3442</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3443</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void GetEventRecord()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3444</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3445</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      double flops = 0.0, mops = 0.0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3446</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3447</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto &amp;K = *arg-&gt;setup-&gt;K;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3448</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      size_t n = arg-&gt;data.proj.col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3449</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      size_t m = 2 * n;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3450</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      size_t k = arg-&gt;data.proj.row();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3451</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3452</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** GEQP3 */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3453</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      flops += ( 4.0 / 3.0 ) * n * n * ( 3 * m - n );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3454</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      mops += ( 2.0 / 3.0 ) * n * n * ( 3 * m - n );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3455</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3456</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /* TRSM */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3457</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      flops += k * ( k - 1 ) * ( n + 1 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3458</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      mops  += 2.0 * ( k * k + k * n );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3459</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3460</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      event.Set( label + name, flops, mops );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3461</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      arg-&gt;data.skeletonize = event;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3462</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3463</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3464</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void DependencyAnalysis()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3465</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3466</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      arg-&gt;DependencyAnalysis( RW, this );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3467</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      this-&gt;TryEnqueue();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3468</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3469</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3470</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Execute( Worker* user_worker )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3471</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3472</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //printf( "%d Par-Skel beg\n", global_rank );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3473</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3474</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      DistSkeletonize&lt;NODE, T&gt;( arg );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3475</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3476</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //printf( "%d Par-Skel end\n", global_rank );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3477</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3478</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3479</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end class SkeletonTask */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3480</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3481</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3482</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3483</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3484</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3485</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3486</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3487</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename NODE, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3488</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>class DistSkeletonizeTask : public hmlp::Task</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3489</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3490</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  public:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3491</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3492</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    NODE *arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3493</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3494</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Set( NODE *user_arg )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3495</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3496</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      arg = user_arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3497</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      name = string( "PSK" );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3498</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      label = to_string( arg-&gt;treelist_id );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3499</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3500</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** We don't know the exact cost here */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3501</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      cost = 5.0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3502</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** "High" priority */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3503</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      priority = true;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3504</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3505</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3506</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void GetEventRecord()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3507</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3508</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      double flops = 0.0, mops = 0.0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3509</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3510</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto &amp;K = *arg-&gt;setup-&gt;K;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3511</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      size_t n = arg-&gt;data.proj.col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3512</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      size_t m = 2 * n;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3513</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      size_t k = arg-&gt;data.proj.row();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3514</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3515</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>			if ( arg-&gt;GetCommRank() == 0 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3516</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>			{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3517</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        /** GEQP3 */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3518</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        flops += ( 4.0 / 3.0 ) * n * n * ( 3 * m - n );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3519</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        mops += ( 2.0 / 3.0 ) * n * n * ( 3 * m - n );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3520</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3521</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>        /* TRSM */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3522</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        flops += k * ( k - 1 ) * ( n + 1 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3523</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        mops  += 2.0 * ( k * k + k * n );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3524</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>			}</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3525</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3526</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      event.Set( label + name, flops, mops );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3527</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      arg-&gt;data.skeletonize = event;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3528</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3529</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3530</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void DependencyAnalysis()</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3531</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3532</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      arg-&gt;DependencyAnalysis( RW, this );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3533</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      this-&gt;TryEnqueue();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3534</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3535</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3536</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Execute( Worker* user_worker )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3537</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3538</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      mpi::Comm comm = arg-&gt;GetComm();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3539</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3540</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      double beg = omp_get_wtime();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3541</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      if ( arg-&gt;GetCommRank() == 0 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3542</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3543</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        DistSkeletonize&lt;NODE, T&gt;( arg );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3544</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3545</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      double skel_t = omp_get_wtime() - beg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3546</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3547</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>			/** Bcast isskel to every MPI processes in the same comm */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3548</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>			int isskel = arg-&gt;data.isskel;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3549</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>			mpi::Bcast( &amp;isskel, 1, 0, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3550</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>			arg-&gt;data.isskel = isskel;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3551</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3552</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Bcast skels and proj to every MPI processes in the same comm */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3553</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto &amp;skels = arg-&gt;data.skels;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3554</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      size_t nskels = skels.size();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3555</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      mpi::Bcast( &amp;nskels, 1, 0, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3556</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      if ( skels.size() != nskels ) skels.resize( nskels );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3557</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      mpi::Bcast( skels.data(), skels.size(), 0, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3558</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3559</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3560</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3561</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end class DistSkeletonTask */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3562</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3563</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3564</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3565</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3566</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3567</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  @brief</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3568</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3569</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename NODE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3570</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>class InterpolateTask : public Task</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3571</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3572</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  public:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3573</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3574</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    NODE *arg = NULL;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3575</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3576</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Set( NODE *user_arg )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3577</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3578</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      arg = user_arg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3579</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      name = string( "PROJ" );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3580</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      label = to_string( arg-&gt;treelist_id );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3581</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      // Need an accurate cost model.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3582</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      cost = 1.0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3583</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3584</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3585</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void DependencyAnalysis() { arg-&gt;DependOnNoOne( this ); };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3586</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3587</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    void Execute( Worker* user_worker )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3588</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3589</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** MPI Support. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3590</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto comm = arg-&gt;GetComm();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3591</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Only executed by rank 0. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3592</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      if ( arg-&gt;GetCommRank() == 0 ) gofmm::Interpolate( arg );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3593</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3594</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      auto &amp;proj  = arg-&gt;data.proj;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3595</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      size_t nrow  = proj.row();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3596</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      size_t ncol  = proj.col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3597</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      mpi::Bcast( &amp;nrow, 1, 0, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3598</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      mpi::Bcast( &amp;ncol, 1, 0, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3599</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      if ( proj.row() != nrow || proj.col() != ncol ) proj.resize( nrow, ncol );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3600</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      mpi::Bcast( proj.data(), proj.size(), 0, comm );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3601</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    };</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3602</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3603</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end class InterpolateTask */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3604</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3605</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3606</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3607</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3608</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3609</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3610</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3611</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3612</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3613</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3614</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3615</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3616</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3617</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3618</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3619</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3620</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3621</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3622</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3623</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3624</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3625</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3626</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3627</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3628</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3629</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3630</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3631</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3632</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3633</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3634</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3635</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  @brief ComputeAll</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3636</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3637</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;bool NNPRUNE = true, typename TREE, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3638</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>DistData&lt;RIDS, STAR, T&gt; Evaluate( TREE &amp;tree, DistData&lt;RIDS, STAR, T&gt; &amp;weights )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3639</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3640</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  try</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3641</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3642</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** MPI Support. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3643</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    int size; mpi::Comm_size( tree.GetComm(), &amp;size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3644</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    int rank; mpi::Comm_rank( tree.GetComm(), &amp;rank );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3645</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Derive type NODE and MPINODE from TREE. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3646</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    using NODE    = typename TREE::NODE;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3647</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    using MPINODE = typename TREE::MPINODE;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3648</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3649</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** All timers */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3650</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    double beg, time_ratio, evaluation_time = 0.0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3651</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    double direct_evaluation_time = 0.0, computeall_time, telescope_time, let_exchange_time, async_time;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3652</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    double overhead_time;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3653</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    double forward_permute_time, backward_permute_time;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3654</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3655</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Clean up all r/w dependencies left on tree nodes. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3656</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.DependencyCleanUp();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3657</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3658</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** n-by-nrhs, initialize potentials. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3659</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    size_t n    = weights.row();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3660</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    size_t nrhs = weights.col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3661</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3662</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Potentials must be in [RIDS,STAR] distribution */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3663</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto &amp;gids_owned = tree.treelist[ 0 ]-&gt;gids;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3664</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    DistData&lt;RIDS, STAR, T&gt; potentials( n, nrhs, gids_owned, tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3665</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    potentials.setvalue( 0.0 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3666</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3667</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Provide pointers. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3668</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.setup.w = &amp;weights;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3669</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.setup.u = &amp;potentials;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3670</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3671</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** TreeView (downward traversal) */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3672</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    gofmm::TreeViewTask&lt;NODE&gt;           seqVIEWtask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3673</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    mpigofmm::DistTreeViewTask&lt;MPINODE&gt; mpiVIEWtask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3674</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Telescope (upward traversal) */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3675</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    gofmm::UpdateWeightsTask&lt;NODE, T&gt;           seqN2Stask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3676</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    mpigofmm::DistUpdateWeightsTask&lt;MPINODE, T&gt; mpiN2Stask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3677</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** L2L (sum of direct evaluations) */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3678</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //mpigofmm::DistLeavesToLeavesTask&lt;NNPRUNE, NODE, T&gt; seqL2Ltask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3679</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //mpigofmm::L2LReduceTask&lt;NODE, T&gt; seqL2LReducetask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3680</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpigofmm::L2LReduceTask2&lt;NODE, T&gt; seqL2LReducetask2;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3681</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** S2S (sum of low-rank approximation) */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3682</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //gofmm::SkeletonsToSkeletonsTask&lt;NNPRUNE, NODE, T&gt;           seqS2Stask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3683</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //mpigofmm::DistSkeletonsToSkeletonsTask&lt;NNPRUNE, MPINODE, T&gt; mpiS2Stask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3684</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //mpigofmm::S2SReduceTask&lt;NODE, T&gt;    seqS2SReducetask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3685</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //mpigofmm::S2SReduceTask&lt;MPINODE, T&gt; mpiS2SReducetask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3686</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpigofmm::S2SReduceTask2&lt;NODE, NODE, T&gt;    seqS2SReducetask2;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3687</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpigofmm::S2SReduceTask2&lt;MPINODE, NODE, T&gt; mpiS2SReducetask2;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3688</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Telescope (downward traversal) */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3689</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    gofmm::SkeletonsToNodesTask&lt;NNPRUNE, NODE, T&gt;           seqS2Ntask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3690</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    mpigofmm::DistSkeletonsToNodesTask&lt;NNPRUNE, MPINODE, T&gt; mpiS2Ntask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3691</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3692</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      /** Global barrier and timer */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3693</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      mpi::Barrier( tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3694</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3695</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3696</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  /** Stage 1: TreeView and upward telescoping */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3697</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  beg = omp_get_wtime();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3698</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  tree.DependencyCleanUp();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3699</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  tree.DistTraverseDown( mpiVIEWtask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3700</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  tree.LocaTraverseDown( seqVIEWtask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3701</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  tree.LocaTraverseUp( seqN2Stask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3702</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  tree.DistTraverseUp( mpiN2Stask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3703</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  hmlp_run();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3704</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  mpi::Barrier( tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3705</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  telescope_time = omp_get_wtime() - beg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3706</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3707</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  /** Stage 2: LET exchange */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3708</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  beg = omp_get_wtime();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3709</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  ExchangeLET&lt;T&gt;( tree, string( "skelweights" ) );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3710</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  mpi::Barrier( tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3711</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  ExchangeLET&lt;T&gt;( tree, string( "leafweights" ) );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3712</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  mpi::Barrier( tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3713</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  let_exchange_time = omp_get_wtime() - beg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3714</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3715</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  /** Stage 3: L2L */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3716</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  beg = omp_get_wtime();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3717</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  tree.DependencyCleanUp();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3718</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  tree.LocaTraverseLeafs( seqL2LReducetask2 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3719</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  hmlp_run();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3720</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  mpi::Barrier( tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3721</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  direct_evaluation_time = omp_get_wtime() - beg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3722</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3723</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  /** Stage 4: S2S and downward telescoping */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3724</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  beg = omp_get_wtime();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3725</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  tree.DependencyCleanUp();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3726</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  tree.LocaTraverseUnOrdered( seqS2SReducetask2 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3727</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  tree.DistTraverseUnOrdered( mpiS2SReducetask2 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3728</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  tree.DistTraverseDown( mpiS2Ntask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3729</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  tree.LocaTraverseDown( seqS2Ntask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3730</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  hmlp_run();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3731</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  mpi::Barrier( tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3732</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //  computeall_time = omp_get_wtime() - beg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3733</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //}</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3734</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3735</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3736</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Global barrier and timer */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3737</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    potentials.setvalue( 0.0 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3738</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpi::Barrier( tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3739</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3740</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Stage 1: TreeView and upward telescoping */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3741</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    beg = omp_get_wtime();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3742</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.DependencyCleanUp();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3743</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.DistTraverseDown( mpiVIEWtask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3744</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.LocaTraverseDown( seqVIEWtask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3745</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.ExecuteAllTasks();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3746</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Stage 2: redistribute weights from IDS to LET. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3747</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    AsyncExchangeLET&lt;T&gt;( tree, string( "leafweights" ) );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3748</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Stage 3: N2S. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3749</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.LocaTraverseUp( seqN2Stask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3750</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.DistTraverseUp( mpiN2Stask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3751</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Stage 4: redistribute skeleton weights from IDS to LET. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3752</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    AsyncExchangeLET&lt;T&gt;( tree, string( "skelweights" ) );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3753</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Stage 5: L2L */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3754</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.LocaTraverseLeafs( seqL2LReducetask2 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3755</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Stage 6: S2S */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3756</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    tree.LocaTraverseUnOrdered( seqS2SReducetask2 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3757</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    tree.DistTraverseUnOrdered( mpiS2SReducetask2 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3758</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Stage 7: S2N */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3759</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.DistTraverseDown( mpiS2Ntask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3760</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.LocaTraverseDown( seqS2Ntask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3761</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    overhead_time = omp_get_wtime() - beg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3762</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.ExecuteAllTasks();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3763</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    async_time = omp_get_wtime() - beg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3764</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3765</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3766</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3767</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Compute the breakdown cost */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3768</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    evaluation_time += direct_evaluation_time;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3769</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    evaluation_time += telescope_time;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3770</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    evaluation_time += let_exchange_time;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3771</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    evaluation_time += computeall_time;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3772</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    time_ratio = 100 / evaluation_time;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3773</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3774</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( rank == 0 &amp;&amp; REPORT_EVALUATE_STATUS )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3775</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3776</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "========================================================\n");</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3777</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "GOFMM evaluation phase\n" );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3778</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "========================================================\n");</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3779</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //printf( "Allocate ------------------------------ %5.2lfs (%5.1lf%%)\n",</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3780</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //    allocate_time, allocate_time * time_ratio );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3781</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //printf( "Forward permute ----------------------- %5.2lfs (%5.1lf%%)\n",</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3782</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //    forward_permute_time, forward_permute_time * time_ratio );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3783</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "Upward telescope ---------------------- %5.2lfs (%5.1lf%%)\n",</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3784</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          telescope_time, telescope_time * time_ratio );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3785</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "LET exchange -------------------------- %5.2lfs (%5.1lf%%)\n",</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3786</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          let_exchange_time, let_exchange_time * time_ratio );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3787</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "L2L ----------------------------------- %5.2lfs (%5.1lf%%)\n",</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3788</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          direct_evaluation_time, direct_evaluation_time * time_ratio );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3789</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "S2S, S2N ------------------------------ %5.2lfs (%5.1lf%%)\n",</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3790</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          computeall_time, computeall_time * time_ratio );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3791</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //printf( "Backward permute ---------------------- %5.2lfs (%5.1lf%%)\n",</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3792</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      //    backward_permute_time, backward_permute_time * time_ratio );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3793</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "========================================================\n");</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3794</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "Evaluate ------------------------------ %5.2lfs (%5.1lf%%)\n",</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3795</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          evaluation_time, evaluation_time * time_ratio );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3796</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "Evaluate (Async) ---------------------- %5.2lfs (%5.2lfs)\n",</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3797</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          async_time, overhead_time );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3798</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "========================================================\n\n");</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3799</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3800</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3801</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    return potentials;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3802</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3803</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  catch ( const exception &amp; e )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3804</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3805</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    cout &lt;&lt; e.what() &lt;&lt; endl;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3806</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    exit( 1 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3807</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3808</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end Evaluate() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3809</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3810</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3811</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3812</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3813</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;bool NNPRUNE = true, typename TREE, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3814</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>DistData&lt;RBLK, STAR, T&gt; Evaluate( TREE &amp;tree, DistData&lt;RBLK, STAR, T&gt; &amp;w_rblk )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3815</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3816</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  size_t n    = w_rblk.row();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3817</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  size_t nrhs = w_rblk.col();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3818</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Redistribute weights from RBLK to RIDS. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3819</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  DistData&lt;RIDS, STAR, T&gt; w_rids( n, nrhs, tree.treelist[ 0 ]-&gt;gids, tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3820</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  w_rids = w_rblk;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3821</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Evaluation with RIDS distribution. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3822</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  auto u_rids = Evaluate&lt;NNPRUNE&gt;( tree, w_rids );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3823</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  mpi::Barrier( tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3824</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Redistribute potentials from RIDS to RBLK. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3825</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  DistData&lt;RBLK, STAR, T&gt; u_rblk( n, nrhs, tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3826</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  u_rblk = u_rids;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3827</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Return potentials in RBLK distribution. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3828</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  return u_rblk;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3829</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end Evaluate() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3830</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3831</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3832</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3833</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename SPLITTER, typename T, typename SPDMATRIX&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3834</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>DistData&lt;STAR, CBLK, pair&lt;T, size_t&gt;&gt; FindNeighbors</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3835</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>(</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3836</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  SPDMATRIX &amp;K,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3837</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  SPLITTER splitter,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3838</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>	gofmm::Configuration&lt;T&gt; &amp;config,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3839</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  mpi::Comm CommGOFMM,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3840</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  size_t n_iter = 10</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3841</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3842</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3843</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Instantiation for the randomized metric tree. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3844</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  using DATA  = gofmm::NodeData&lt;T&gt;;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3845</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  using SETUP = mpigofmm::Setup&lt;SPDMATRIX, SPLITTER, T&gt;;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3846</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  using TREE  = mpitree::Tree&lt;SETUP, DATA&gt;;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3847</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Derive type NODE from TREE. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3848</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  using NODE  = typename TREE::NODE;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3849</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Get all user-defined parameters. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3850</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  DistanceMetric metric = config.MetricType();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3851</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  size_t n = config.ProblemSize();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3852</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>	size_t k = config.NeighborSize();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3853</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Iterative all nearnest-neighbor (ANN). */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3854</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  pair&lt;T, size_t&gt; init( numeric_limits&lt;T&gt;::max(), n );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3855</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  gofmm::NeighborsTask&lt;NODE, T&gt; NEIGHBORStask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3856</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  TREE rkdt( CommGOFMM );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3857</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  rkdt.setup.FromConfiguration( config, K, splitter, NULL );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3858</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  return rkdt.AllNearestNeighbor( n_iter, n, k, init, NEIGHBORStask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3859</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end FindNeighbors() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3860</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3861</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3862</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3863</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3864</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3865</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3866</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3867</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3868</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3869</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/**</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3870</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> *  @brief template of the compress routine</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3871</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre> */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3872</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename SPLITTER, typename RKDTSPLITTER, typename T, typename SPDMATRIX&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3873</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>mpitree::Tree&lt;mpigofmm::Setup&lt;SPDMATRIX, SPLITTER, T&gt;, gofmm::NodeData&lt;T&gt;&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3874</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>*Compress</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3875</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>(</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3876</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  SPDMATRIX &amp;K,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3877</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  DistData&lt;STAR, CBLK, pair&lt;T, size_t&gt;&gt; &amp;NN_cblk,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3878</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  SPLITTER splitter,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3879</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  RKDTSPLITTER rkdtsplitter,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3880</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>	gofmm::Configuration&lt;T&gt; &amp;config,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3881</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  mpi::Comm CommGOFMM</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3882</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3883</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3884</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  try</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3885</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3886</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** MPI size ane rank. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3887</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    int size; mpi::Comm_size( CommGOFMM, &amp;size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3888</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    int rank; mpi::Comm_rank( CommGOFMM, &amp;rank );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3889</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3890</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Get all user-defined parameters. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3891</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    DistanceMetric metric = config.MetricType();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3892</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    size_t n = config.ProblemSize();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3893</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>	  size_t m = config.LeafNodeSize();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3894</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>	  size_t k = config.NeighborSize();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3895</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>	  size_t s = config.MaximumRank();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3896</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3897</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** options */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3898</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    const bool SYMMETRIC = true;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3899</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    const bool NNPRUNE   = true;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3900</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    const bool CACHE     = true;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3901</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3902</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Instantiation for the GOFMM metric tree. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3903</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    using SETUP   = mpigofmm::Setup&lt;SPDMATRIX, SPLITTER, T&gt;;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3904</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    using DATA    = gofmm::NodeData&lt;T&gt;;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3905</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    using TREE    = mpitree::Tree&lt;SETUP, DATA&gt;;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3906</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Derive type NODE and MPINODE from TREE. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3907</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    using NODE    = typename TREE::NODE;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3908</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    using MPINODE = typename TREE::MPINODE;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3909</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3910</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** All timers. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3911</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    double beg, omptask45_time, omptask_time, ref_time;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3912</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    double time_ratio, compress_time = 0.0, other_time = 0.0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3913</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    double ann_time, tree_time, skel_time, mpi_skel_time, mergefarnodes_time, cachefarnodes_time;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3914</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    double local_skel_time, dist_skel_time, let_time;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3915</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    double nneval_time, nonneval_time, fmm_evaluation_time, symbolic_evaluation_time;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3916</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    double exchange_neighbor_time, symmetrize_time;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3917</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3918</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Iterative all nearnest-neighbor (ANN). */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3919</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    beg = omp_get_wtime();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3920</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( k &amp;&amp; NN_cblk.row() * NN_cblk.col() != k * n )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3921</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3922</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      NN_cblk = mpigofmm::FindNeighbors( K, rkdtsplitter,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3923</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          config, CommGOFMM );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3924</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3925</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    ann_time = omp_get_wtime() - beg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3926</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3927</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Initialize metric ball tree using approximate center split. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3928</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto *tree_ptr = new TREE( CommGOFMM );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3929</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>	  auto &amp;tree = *tree_ptr;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3930</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3931</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>	  /** Global configuration for the metric tree. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3932</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    tree.setup.FromConfiguration( config, K, splitter, &amp;NN_cblk );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3933</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3934</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>	  /** Metric ball tree partitioning. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3935</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    beg = omp_get_wtime();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3936</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.TreePartition();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3937</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree_time = omp_get_wtime() - beg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3938</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3939</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Get tree permutataion. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3940</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    vector&lt;size_t&gt; perm = tree.GetPermutation();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3941</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( rank == 0 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3942</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3943</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      ofstream perm_file( "perm.txt" );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3944</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      for ( auto &amp;id : perm ) perm_file &lt;&lt; id &lt;&lt; " ";</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3945</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      perm_file.close();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3946</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3947</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3948</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3949</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Redistribute neighbors i.e. NN[ *, CIDS ] = NN[ *, CBLK ]; */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3950</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    DistData&lt;STAR, CIDS, pair&lt;T, size_t&gt;&gt; NN( k, n, tree.treelist[ 0 ]-&gt;gids, tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3951</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    NN = NN_cblk;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3952</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.setup.NN = &amp;NN;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3953</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    beg = omp_get_wtime();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3954</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    ExchangeNeighbors&lt;T&gt;( tree );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3955</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    exchange_neighbor_time = omp_get_wtime() - beg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3956</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3957</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3958</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    beg = omp_get_wtime();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3959</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Construct near interaction lists. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3960</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    FindNearInteractions( tree );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3961</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Symmetrize interaction pairs by Alltoallv. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3962</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpigofmm::SymmetrizeNearInteractions( tree );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3963</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Split node interaction lists per MPI rank. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3964</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    BuildInteractionListPerRank( tree, true );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3965</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Exchange {leafs} and {paramsleafs)}.  */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3966</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    ExchangeLET( tree, string( "leafgids" ) );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3967</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    symmetrize_time = omp_get_wtime() - beg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3968</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3969</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3970</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Find and merge far interactions. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3971</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpi::PrintProgress( "[BEG] MergeFarNodes ...", tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3972</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    beg = omp_get_wtime();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3973</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.DependencyCleanUp();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3974</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    MergeFarNodesTask&lt;true, NODE, T&gt; seqMERGEtask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3975</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    DistMergeFarNodesTask&lt;true, MPINODE, T&gt; mpiMERGEtask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3976</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.LocaTraverseUp( seqMERGEtask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3977</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.DistTraverseUp( mpiMERGEtask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3978</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.ExecuteAllTasks();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3979</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mergefarnodes_time += omp_get_wtime() - beg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3980</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpi::PrintProgress( "[END] MergeFarNodes ...", tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3981</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3982</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Symmetrize interaction pairs by Alltoallv. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3983</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    beg = omp_get_wtime();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3984</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpigofmm::SymmetrizeFarInteractions( tree );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3985</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Split node interaction lists per MPI rank. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3986</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    BuildInteractionListPerRank( tree, false );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3987</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    symmetrize_time += omp_get_wtime() - beg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3988</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3989</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpi::PrintProgress( "[BEG] Skeletonization ...", tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3990</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Skeletonization */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3991</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>	  beg = omp_get_wtime();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3992</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.DependencyCleanUp();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3993</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Gather sample rows and skeleton columns, then ID */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3994</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    gofmm::SkeletonKIJTask&lt;NNPRUNE, NODE, T&gt; seqGETMTXtask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3995</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    mpigofmm::DistSkeletonKIJTask&lt;NNPRUNE, MPINODE, T&gt; mpiGETMTXtask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3996</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    mpigofmm::SkeletonizeTask&lt;NODE, T&gt; seqSKELtask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3997</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    mpigofmm::DistSkeletonizeTask&lt;MPINODE, T&gt; mpiSKELtask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3998</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.LocaTraverseUp( seqGETMTXtask, seqSKELtask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3999</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //tree.DistTraverseUp( mpiGETMTXtask, mpiSKELtask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4000</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Compute the coefficient matrix of ID */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4001</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    gofmm::InterpolateTask&lt;NODE&gt; seqPROJtask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4002</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    mpigofmm::InterpolateTask&lt;MPINODE&gt; mpiPROJtask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4003</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    tree.LocaTraverseUnOrdered( seqPROJtask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4004</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //tree.DistTraverseUnOrdered( mpiPROJtask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4005</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4006</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Cache near KIJ interactions */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4007</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    mpigofmm::CacheNearNodesTask&lt;NNPRUNE, NODE&gt; seqNEARKIJtask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4008</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //tree.LocaTraverseLeafs( seqNEARKIJtask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4009</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4010</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.ExecuteAllTasks();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4011</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    skel_time = omp_get_wtime() - beg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4012</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4013</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>	  beg = omp_get_wtime();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4014</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.DistTraverseUp( mpiGETMTXtask, mpiSKELtask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4015</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    tree.DistTraverseUnOrdered( mpiPROJtask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4016</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.ExecuteAllTasks();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4017</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpi_skel_time = omp_get_wtime() - beg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4018</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpi::PrintProgress( "[END] Skeletonization ...", tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4019</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4020</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4021</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4022</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Exchange {skels} and {params(skels)}.  */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4023</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    ExchangeLET( tree, string( "skelgids" ) );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4024</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4025</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    beg = omp_get_wtime();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4026</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Cache near KIJ interactions */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4027</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //mpigofmm::CacheNearNodesTask&lt;NNPRUNE, NODE&gt; seqNEARKIJtask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4028</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //tree.LocaTraverseLeafs( seqNEARKIJtask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4029</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Cache far KIJ interactions */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4030</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    mpigofmm::CacheFarNodesTask&lt;NNPRUNE,    NODE&gt; seqFARKIJtask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4031</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    mpigofmm::CacheFarNodesTask&lt;NNPRUNE, MPINODE&gt; mpiFARKIJtask;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4032</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //tree.LocaTraverseUnOrdered( seqFARKIJtask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4033</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    //tree.DistTraverseUnOrdered( mpiFARKIJtask );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4034</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    cachefarnodes_time = omp_get_wtime() - beg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4035</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree.ExecuteAllTasks();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4036</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    cachefarnodes_time = omp_get_wtime() - beg;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4037</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4038</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4039</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4040</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Compute the ratio of exact evaluation. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4041</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto ratio = NonCompressedRatio( tree );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4042</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4043</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    double exact_ratio = (double) m / n;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4044</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4045</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( rank == 0 &amp;&amp; REPORT_COMPRESS_STATUS )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4046</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4047</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      compress_time += ann_time;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4048</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      compress_time += tree_time;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4049</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      compress_time += exchange_neighbor_time;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4050</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      compress_time += symmetrize_time;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4051</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      compress_time += skel_time;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4052</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      compress_time += mpi_skel_time;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4053</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      compress_time += mergefarnodes_time;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4054</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      compress_time += cachefarnodes_time;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4055</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      time_ratio = 100.0 / compress_time;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4056</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "========================================================\n");</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4057</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "GOFMM compression phase\n" );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4058</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "========================================================\n");</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4059</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "NeighborSearch ------------------------ %5.2lfs (%5.1lf%%)\n", ann_time, ann_time * time_ratio );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4060</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "TreePartitioning ---------------------- %5.2lfs (%5.1lf%%)\n", tree_time, tree_time * time_ratio );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4061</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "ExchangeNeighbors --------------------- %5.2lfs (%5.1lf%%)\n", exchange_neighbor_time, exchange_neighbor_time * time_ratio );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4062</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "MergeFarNodes ------------------------- %5.2lfs (%5.1lf%%)\n", mergefarnodes_time, mergefarnodes_time * time_ratio );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4063</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "Symmetrize ---------------------------- %5.2lfs (%5.1lf%%)\n", symmetrize_time, symmetrize_time * time_ratio );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4064</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "Skeletonization (HMLP Runtime   ) ----- %5.2lfs (%5.1lf%%)\n", skel_time, skel_time * time_ratio );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4065</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "Skeletonization (MPI            ) ----- %5.2lfs (%5.1lf%%)\n", mpi_skel_time, mpi_skel_time * time_ratio );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4066</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "Cache KIJ ----------------------------- %5.2lfs (%5.1lf%%)\n", cachefarnodes_time, cachefarnodes_time * time_ratio );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4067</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "========================================================\n");</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4068</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "%5.3lf%% and %5.3lf%% uncompressed--------- %5.2lfs (%5.1lf%%)\n",</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4069</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>          100 * ratio.first, 100 * ratio.second, compress_time, compress_time * time_ratio );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4070</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "========================================================\n\n");</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4071</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4072</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4073</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Cleanup all w/r dependencies on tree nodes */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4074</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    tree_ptr-&gt;DependencyCleanUp();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4075</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Global barrier to make sure all processes have completed */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4076</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpi::Barrier( tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4077</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4078</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    return tree_ptr;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4079</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4080</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  catch ( const exception &amp; e )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4081</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4082</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    cout &lt;&lt; e.what() &lt;&lt; endl;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4083</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    exit( 1 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4084</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4085</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end Compress() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4086</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4087</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4088</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4089</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename TREE, typename T&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4090</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>pair&lt;T, T&gt; ComputeError( TREE &amp;tree, size_t gid, Data&lt;T&gt; potentials )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4091</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4092</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int comm_rank; mpi::Comm_rank( tree.GetComm(), &amp;comm_rank );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4093</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int comm_size; mpi::Comm_size( tree.GetComm(), &amp;comm_size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4094</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4095</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** ( sum of square errors, square 2-norm of true values ) */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4096</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  pair&lt;T, T&gt; ret( 0, 0 );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4097</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4098</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto &amp;K = *tree.setup.K;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4099</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto &amp;w = *tree.setup.w;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4100</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4101</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto  I = vector&lt;size_t&gt;( 1, gid );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4102</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto &amp;J = tree.treelist[ 0 ]-&gt;gids;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4103</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4104</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Bcast gid and its parameter to all MPI processes. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4105</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  K.BcastIndices( I, gid % comm_size, tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4106</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4107</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>	Data&lt;T&gt; Kab = K( I, J );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4108</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4109</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto loc_exact = potentials;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4110</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto glb_exact = potentials;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4111</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4112</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  xgemm( "N", "N", Kab.row(), w.col(), w.row(),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4113</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    1.0,       Kab.data(),       Kab.row(),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4114</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 w.data(),         w.row(),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4115</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    0.0, loc_exact.data(), loc_exact.row() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4116</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //gemm::xgemm( (T)1.0, Kab, w, (T)0.0, loc_exact );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4117</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4118</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4119</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4120</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4121</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Allreduce u( gid, : ) = K( gid, CBLK ) * w( RBLK, : ) */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4122</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  mpi::Allreduce( loc_exact.data(), glb_exact.data(),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4123</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      loc_exact.size(), MPI_SUM, tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4124</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4125</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( uint64_t j = 0; j &lt; w.col(); j ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4126</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4127</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    T exac = glb_exact[ j ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4128</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    T pred = potentials[ j ];</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4129</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Accumulate SSE and sqaure 2-norm. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4130</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    ret.first  += ( pred - exac ) * ( pred - exac );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4131</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    ret.second += exac * exac;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4132</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4133</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4134</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  return ret;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4135</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end ComputeError() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4136</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4137</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4138</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4139</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4140</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4141</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4142</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4143</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4144</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4145</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4146</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename TREE&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4147</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void SelfTesting( TREE &amp;tree, size_t ntest, size_t nrhs )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4148</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4149</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Derive type T from TREE. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4150</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  using T = typename TREE::T;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4151</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** MPI Support. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4152</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int rank; mpi::Comm_rank( tree.GetComm(), &amp;rank );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4153</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  int size; mpi::Comm_size( tree.GetComm(), &amp;size );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4154</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Size of right hand sides. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4155</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  size_t n = tree.n;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4156</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Shrink ntest if ntest &gt; n. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4157</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  if ( ntest &gt; n ) ntest = n;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4158</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** all_rhs = [ 0, 1, ..., nrhs - 1 ]. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4159</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  vector&lt;size_t&gt; all_rhs( nrhs );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4160</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( size_t rhs = 0; rhs &lt; nrhs; rhs ++ ) all_rhs[ rhs ] = rhs;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4161</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4162</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  //auto A = tree.CheckAllInteractions();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4163</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4164</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Input and output in RIDS and RBLK. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4165</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  DistData&lt;RIDS, STAR, T&gt; w_rids( n, nrhs, tree.treelist[ 0 ]-&gt;gids, tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4166</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  DistData&lt;RBLK, STAR, T&gt; u_rblk( n, nrhs, tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4167</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Initialize with random N( 0, 1 ). */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4168</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  w_rids.randn();</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4169</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Evaluate u ~ K * w. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4170</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto u_rids = mpigofmm::Evaluate&lt;true&gt;( tree, w_rids );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4171</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Sanity check for INF and NAN. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4172</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  assert( !u_rids.HasIllegalValue() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4173</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Redistribute potentials from RIDS to RBLK. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4174</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  u_rblk = u_rids;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4175</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Report elementwise and F-norm accuracy. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4176</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  if ( rank == 0 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4177</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4178</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    printf( "========================================================\n");</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4179</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    printf( "Accuracy report\n" );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4180</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    printf( "========================================================\n");</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4181</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4182</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** All statistics. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4183</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  T nnerr_avg = 0.0, nonnerr_avg = 0.0, fmmerr_avg = 0.0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4184</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  T sse_2norm = 0.0, ssv_2norm = 0.0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4185</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Loop over all testing gids and right hand sides. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4186</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  for ( size_t i = 0; i &lt; ntest; i ++ )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4187</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4188</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    size_t tar = i * n / ntest;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4189</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    Data&lt;T&gt; potentials( (size_t)1, nrhs );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4190</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( rank == ( tar % size ) ) potentials = u_rblk( vector&lt;size_t&gt;( 1, tar ), all_rhs );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4191</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Bcast potentials to all MPI processes. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4192</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    mpi::Bcast( potentials.data(), nrhs, tar % size, tree.GetComm() );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4193</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Compare potentials with exact MATVEC. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4194</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto sse_ssv = mpigofmm::ComputeError( tree, tar, potentials );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4195</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Compute element-wise 2-norm error. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4196</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    auto fmmerr  = sqrt( sse_ssv.first / sse_ssv.second );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4197</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Accumulate element-wise 2-norm error. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4198</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    fmmerr_avg += fmmerr;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4199</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Accumulate SSE and SSV. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4200</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    sse_2norm += sse_ssv.first;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4201</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    ssv_2norm += sse_ssv.second;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4202</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    /** Only print 10 values. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4203</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    if ( i &lt; 10 &amp;&amp; rank == 0 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4204</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4205</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      printf( "gid %6lu, ASKIT %3.1E, HODLR %3.1E, GOFMM %3.1E\n",</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4206</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>          tar, 0.0, 0.0, fmmerr );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4207</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>    }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4208</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4209</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  if ( rank == 0 )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4210</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  {</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4211</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    printf( "========================================================\n");</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4212</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    printf( "Elementwise ASKIT %3.1E, HODLR %3.1E, GOFMM %3.1E\n",</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4213</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        nnerr_avg / ntest , nonnerr_avg / ntest, fmmerr_avg / ntest );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4214</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    printf( "F-norm      ASKIT %3.1E, HODLR %3.1E, GOFMM %3.1E\n",</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4215</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>        0.0, 0.0, sqrt( sse_2norm / ssv_2norm ) );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4216</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>    printf( "========================================================\n");</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4217</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4218</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4219</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Factorization */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4220</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  T lambda = 10.0;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4221</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  mpigofmm::DistFactorize( tree, lambda );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4222</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  mpigofmm::ComputeError( tree, lambda, w_rids, u_rids );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4223</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>}; /** end SelfTesting() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4224</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4225</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4226</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>/** @brief Instantiate the splitters here. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4227</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>template&lt;typename SPDMATRIX&gt;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4228</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>void LaunchHelper( SPDMATRIX &amp;K, gofmm::CommandLineHelper &amp;cmd, mpi::Comm CommGOFMM )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4229</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>{</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4230</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  using T = typename SPDMATRIX::T;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4231</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  const int N_CHILDREN = 2;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4232</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Use geometric-oblivious splitters. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4233</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  using SPLITTER     = mpigofmm::centersplit&lt;SPDMATRIX, N_CHILDREN, T&gt;;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4234</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  using RKDTSPLITTER = mpigofmm::randomsplit&lt;SPDMATRIX, N_CHILDREN, T&gt;;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4235</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** GOFMM tree splitter. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4236</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  SPLITTER splitter( K );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4237</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  splitter.Kptr = &amp;K;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4238</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  splitter.metric = cmd.metric;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4239</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Randomized tree splitter. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4240</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  RKDTSPLITTER rkdtsplitter( K );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4241</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  rkdtsplitter.Kptr = &amp;K;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4242</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  rkdtsplitter.metric = cmd.metric;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4243</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>	/** Create configuration for all user-define arguments. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4244</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  gofmm::Configuration&lt;T&gt; config( cmd.metric,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4245</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      cmd.n, cmd.m, cmd.k, cmd.s, cmd.stol, cmd.budget );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4246</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** (Optional) provide neighbors, leave uninitialized otherwise. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4247</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  DistData&lt;STAR, CBLK, pair&lt;T, size_t&gt;&gt; NN( 0, cmd.n, CommGOFMM );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4248</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Compress matrix K. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4249</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  auto *tree_ptr = mpigofmm::Compress( K, NN, splitter, rkdtsplitter, config, CommGOFMM );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4250</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  auto &amp;tree = *tree_ptr;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4251</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4252</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>  /** Examine accuracies. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4253</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  mpigofmm::SelfTesting( tree, 100, cmd.nrhs );</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4254</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4255</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>	/** Delete tree_ptr. */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4256</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>  delete tree_ptr;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4257</pre></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>}; /** end test_gofmm_setup() */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4258</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4259</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4260</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end namespace gofmm */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4261</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>}; /** end namespace hmlp */</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4262</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4263</pre></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif /** define GOFMM_MPI_HPP */</pre></td>
    </tr>

  </table>
  <br>

  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr><td class="hr"><td></tr>
    <tr><td class="footer">Generated by: <a href="http://gcovr.com">GCOVR (Version 3.2)</a></td></tr>
  </table>
  <br>

</body>

</html>

